# /etc/security/pwquality.conf
#
# NOTE: This file handles only password “quality” rules. Additional rules – such as MFA, 
# password history/deny lists, account inactivity locks, login throttling, and alerts – 
# must be implemented via PAM modules, external scripts, or other system security settings.
#
# 1. MFA is required wherever possible.
#    (This file does not configure MFA; please enforce MFA via appropriate PAM modules and other mechanisms.)
#
# 2. Password length requirements:
#    - For password‐only accounts, a minimum length of 14 characters is required.
#    - For MFA‐enabled accounts, a minimum length of 8 characters should be allowed.
#      (A single global value is applied here; ensure that MFA-enabled accounts are configured to allow a lower minimum 
#      via separate policy or PAM settings as needed.)
minlen = 14
#
# 3. Maximum password length:
#    - No maximum is explicitly enforced here. The system will accept passwords up to the implementation limits.
#
# 4. Character requirements:
#    - All character types are allowed.
#    - For password‐only accounts, at least one non‐alphabetic character is required.
#      (Setting ocredit to -1 ensures one non-alphanumeric character is mandatory.)
ocredit = -1
#
# 5. Password expiration and breach response:
#    - In the event of a breach, passwords must be changed immediately.
#      An annual expiration serves as a backstop. (This rule should be enforced via PAM/policy configurations such as /etc/login.defs or account management tools.)
#
# 6. Deny list and history checking:
#    - New passwords are checked against an internal deny list of at least 20 common/weak passwords and the previous 5 used.
#      (This functionality must be provided by integrating pam_pwhistory and/or custom deny list modules.)
#
# 7. Change delay:
#    - A password change delay of at least one day is enforced.
#      (Implement this via PAM or your account management framework.)
#
# 8. Inactivity session lock:
#    - The current session should lock after 15 minutes (or less) of inactivity.
#      (This configuration must be set in your desktop or terminal session management settings.)
#
# 9. Account lockout:
#    - Temporary account lockout of at least 15 minutes after five consecutive failed login attempts.
#      (Further time-doubling throttling – 0, 1, 2, 4, 8, … minutes between retries – with a permanent lockout after 12 retries
#       must be configured in your PAM faillock or similar settings.)
#    - Alert key personnel when bad login attempts reach the limit.
#      (Monitoring/alerting must be implemented using system logging/monitoring tools.)
#
# 10. Account suspension:
#     - Automatically suspend the account after 45 days without a valid login.
#       (This requires separate configuration via account management policies.)
#
# 11. Password hints:
#     - Do not allow user-defined password hints at login.
#       (This must be enforced via your login/display manager configuration.)
#
# Additional pwquality settings (adjust as needed):
dcredit = 0
ucredit = 0
lcredit = 0

# End of /etc/security/pwquality.conf
