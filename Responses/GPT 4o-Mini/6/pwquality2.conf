# /etc/security/pwquality.conf
#
# Password Policy Settings
#
# 1. MFA Requirement
#    MFA is required wherever possible. Note that MFA configuration is handled outside
#    of pwquality; this file enforces quality specifics for the underlying password.
#
# 2. Minimum Password Length
#    For password‐only accounts, a minimum length of 14 characters is required.
#    For accounts with MFA enabled, the effective minimum length may be lowered to 8.
#    (Adjust the PAM configuration for MFA-enabled accounts accordingly.)
minlen = 14
#
# 3. Maximum Password Length
#    No maximum limit is imposed here; system constraints will govern the absolute maximum.
#
# 4. Character Requirements
#    All character types are allowed.
#    For password‐only accounts, enforce at least one non‐alphabetic character.
#    One way to require at least one non‐alphabetic character is by requiring at least
#    one digit. (If you prefer to allow a special character in lieu of a digit, adjust as needed.)
dcredit = -1
#
#    Additionally, require that at least two distinct character classes are used.
#    This helps ensure that passwords are not composed solely of alphabetic characters.
minclass = 2
#
# 5. Password Change and Expiration
#    In event of a breach, passwords must be changed immediately;
#    an annual expiration serves as a backstop.
#    (Password change enforcement and expiration are managed via PAM/account management tools.)
#
# 6. Deny List and Password History
#    New passwords are checked against an internal deny list of known weak passwords
#    (which should include at least 20 common bad choices) and the previous 5 passwords.
#    The dictionary check is enabled below, and the deny list file must be maintained separately.
dictcheck = 1
badwordsfile = /etc/security/badwords
#
# 7. Change Delay
#    A minimum delay of one day between password changes is required.
#    (This is enforced via other PAM modules and is not configured here.)
#
# 8. Session and Lockout Policies
#    - Current sessions should auto-lock after 15 minutes (or less) of inactivity.
#    - Temporary account lockout (15 minutes or more) is applied after five consecutive failed attempts.
#    - Throttling (with doubling delays between attempts and permanent lockout after 12 retries)
#      is implemented outside of pwquality by the account/security modules.
#
# 9. Monitoring and Alerts
#    Alerts are sent to key personnel when bad login attempts reach the defined limit.
#    (This monitoring is handled by external security systems.)
#
# 10. Account Suspension and Hints
#     - Accounts are automatically suspended after 45 days without a valid login.
#     - User-defined password hints at login are not permitted.
#     (Both of these policies are managed outside of pwquality.)
#
# Note:
# Many of the policies listed above (e.g. MFA, session lockouts, throttling, account suspension,
# password history, change delays, and monitoring) are enforced via PAM modules or other account
# management and security tools. The pwquality.conf file is used solely to enforce password content
# and complexity requirements.
