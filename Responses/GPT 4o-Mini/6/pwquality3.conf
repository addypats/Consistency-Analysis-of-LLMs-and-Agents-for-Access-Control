# /etc/security/pwquality.conf
#
# This configuration file defines password quality policies.
# Note: Several requirements below (MFA settings, session locking, account lockouts,
# password expirations, throttling, inactivity suspension, and password hint prevention)
# are enforced outside of pwquality (e.g. via PAM, login.defs, external scripts, or application settings).
#
# 1. MFA
#    • Enforce MFA wherever possible (see 2.1).
#       NOTE: MFA configuration is handled separately from pwquality.
#
# 2. Password Length Requirements
#    • For password‐only accounts, require a minimum of 14 characters.
minlen=14
#    • For accounts that use MFA, a minimum of 8 characters is acceptable.
#       NOTE: Enforcing different minimum lengths per account type must be configured elsewhere.
#
# 3. Maximum Password Length
#    • Do not restrict the maximum length of passwords (system constraints apply).
#       (No maxlen parameter is set.)
#
# 4. Character Requirements
#    • Allow all character types.
#    • For password‐only accounts, require at least one non‐alphabetic character.
#       NOTE: pwquality does not provide conditional character rules. Ensure external validation
#             (for example, requiring at least one digit or special symbol) for password‐only accounts.
#
# 5. Password Change and History
#    • In the event of a breach, force an immediate password change with an annual expiration as a backstop.
#       NOTE: Password expiration and immediate change are typically managed via PAM/chage settings.
#
#    • Check new passwords against an internal deny list (including 20+ known weak passwords)
#      and disallow reuse of the previous 5 passwords.
dictcheck=1
#    • If using a custom dictionary of bad/weak passwords, specify its path (adjust as needed):
#       dictpath=/etc/security/dict/weakpw.txt
#
#    • Remember the previous 5 passwords to prevent reuse.
remember=5
#
# 6. Password Change Delay
#    • Enforce a minimum delay of 1 day between password changes.
#       NOTE: This is typically set in PAM configuration (e.g. via pam_pwhistory) and is not handled here.
#
# 7. Session and Account Lockout Rules
#    • Lock the current session after 15 minutes or less of inactivity.
#    • Temporarily lock out the account for at least 15 minutes after five consecutive failed attempts.
#    • Employ a time-doubling throttling mechanism (0, 1, 2, 4, 8, … minutes) for retries,
#      and enforce a permanent lockout (requiring an IT reset) after 12 retries.
#    • Monitor and alert key personnel when failed login attempts reach the limit.
#    • Automatically suspend the account after 45 days without a valid login.
#
#       NOTE: These session/lockout policies are enforced using PAM modules (e.g. pam_faillock)
#             and system security settings, not via pwquality.
#
# 8. Password Hints
#    • Do not allow user-defined password "hints" at login.
#       NOTE: This is enforced at the application or PAM level, not within pwquality.
#
# End of /etc/security/pwquality.conf
