# /etc/security/pwquality.conf
#
# This file partially enforces our overall password policy. Note that many of the
# rules (such as MFA settings, account lockouts, password aging, session locking,
# login throttling, monitoring/alerting, and account suspension) must be configured
# via PAM modules, system account policies, or external monitoring and are noted
# here for documentation only.
#
# 1. MFA is recommended wherever possible.
#    (Implement MFA via your system’s authentication mechanisms; it cannot be set here.)
#
# 2. Minimum password length:
#    - For password‐only accounts, a minimum of 14 characters is required.
#    - For MFA-enabled accounts, a minimum of 8 characters is acceptable.
#    (Below we set minlen=14 by default. Adjust MFA accounts to allow an 8‐character
#     minimum via your PAM or application configuration as needed.)
minlen = 14
#
# 3. Maximum password length:
#    There is no maximum length enforced here; passwords may be as long as system constraints allow.
#
# 4. Character type requirements for password-only accounts:
#    All character types are allowed. However, at least one non‐alphabetic character
#    (digit or special character) is required. The settings below require that at least
#    one digit (dcredit) and one special (non-alphanumeric) character (ocredit) be present.
#    (Note: pwquality.conf cannot dynamically differentiate based on MFA status.)
dcredit = -1
ocredit = -1
#
# 5. Password expiration and breach response:
#    In the event of a breach, passwords should be changed immediately with an annual
#    expiration serving as a backstop. Configure these policies using your system’s
#    password aging and account management settings (e.g. in /etc/login.defs or via chage).
#
# 6. Dictionary and history checks:
#    New passwords are checked against an internal deny list of known weak passwords
#    (at least 20 common ones) and must not match any of the previous five passwords.
#    Enabling dictcheck below will enforce a check against the specified dictionary file.
#    (To enforce password history, ensure PAM’s password history module is configured accordingly.)
dictcheck = 1
dictpath = /etc/security/denylist.txt
#
# 7. Password change delay:
#    A minimum delay of one day between password changes must be enforced. This setting
#    must be applied via PAM’s password history or similar mechanism.
#
# 8. Session locking:
#    Inactivity of 15 minutes (or less) should trigger session lock. Configure this via
#    your desktop or remote session management settings.
#
# 9. Account lockout and throttling:
#    After five consecutive failed login attempts, a temporary account lockout should occur
#    (15 minutes or longer) with time doubling delays between retries (0, 1, 2, 4, 8, …)
#    and a permanent lockout after 12 retries requiring an IT reset.
#    These policies must be enforced using PAM's faillock (or equivalent) configuration.
#
# 10. Monitoring and alerting:
#     Alert key personnel when bad login attempts reach the threshold. Implement this via
#     your system monitoring and logging infrastructure.
#
# 11. Automatic account suspension:
#     Accounts should be automatically suspended after 45 days without a valid login.
#     This is managed by your account and session management policies.
#
# 12. Password hints:
#     User-defined password hints at login are not allowed. Ensure your login interface
#     disables this feature.
#
# End of policy settings for pwquality module.
