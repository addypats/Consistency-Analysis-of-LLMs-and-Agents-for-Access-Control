# /etc/security/pwquality.conf
#
# 2.1 MFA: Use multi-factor authentication wherever possible.
#     NOTE: MFA configuration is handled via appropriate PAM modules and external systems.
#
# 5.1.1 Password Length:
#   - For password‐only accounts, a minimum length of 14 characters is required.
#   - For MFA‐enabled accounts, a minimum length of 8 characters is required.
#     NOTE: This file sets the default minimum length. For MFA-enabled accounts, adjust the
#           PAM service configuration accordingly.
minlen = 14
# No maximum length is imposed; passwords may be as long as allowed by the system.
#
# 5.1.2 Character Requirements:
#   - All character types are allowed.
#   - For password-only accounts, at least one non-alphabetic character is required.
#     Here, a minimum requirement of one digit is enforced.
dcredit = -1
# (If a requirement for a special (non-alphanumeric) character is desired instead,
#  consider adding custom checks or adjusting PAM configuration.)
#
# 5.1.3 Password Expiration:
#   - In the event of a breach the password must be changed immediately,
#     with an annual expiration serving as a backstop.
#     NOTE: This is enforced via system password and account management tools (e.g. chage)
#           and is not handled by pwquality.
#
# 5.1.4 Deny List and History Checks:
#   - New passwords are checked against an internal deny list of known bad or weak passwords,
#     as well as against the previous 5 passwords.
#     The dictionary check is enabled below.
dictcheck = 1
#     NOTE: The deny list file (which should contain at least 20 common weak passwords)
#           must be configured in the supplementary PAM or system policy.
#     NOTE: Enforcement of password history is typically managed by the pam_pwhistory module.
#
# 5.1.4 Password Change Delay:
#   - A minimum delay of one day between password changes is required.
#     NOTE: This delay is generally enforced via PAM (e.g. in pam_pwhistory) rather than here.
#
# 5.1.5 Session Lock:
#   - Active sessions must be locked after 15 minutes (or less) of inactivity.
#     NOTE: Session locking is controlled by the desktop or terminal session manager, not by pwquality.
#
# 5.1.6 Account Lockout and Throttling:
#   - After five consecutive failed login attempts a temporary account lockout of at least 15 minutes is enforced.
#   - Subsequent retries follow a time doubling scheme (e.g. 0, 1, 2, 4, 8, ... minutes)
#     with a permanent lockout (IT reset required) after 12 retries.
#     NOTE: These lockout and throttling policies are implemented via PAM modules (such as pam_faillock) and not here.
#
# 5.1.7 Alerting on Bad Login Attempts:
#   - Key personnel are to be alerted when bad login attempts reach the set limit.
#     NOTE: This requires external monitoring and alerting mechanisms.
#
# 5.1.8 Inactive Account Suspension:
#   - Accounts are automatically suspended after 45 days without a valid login.
#     NOTE: This is managed by the account management configuration (e.g. /etc/shadow settings) and not via pwquality.
#
# 5.1.9 Password Hints:
#   - User-defined password hints at login are not allowed.
#     NOTE: This is controlled by the login interface and is not part of this configuration.
