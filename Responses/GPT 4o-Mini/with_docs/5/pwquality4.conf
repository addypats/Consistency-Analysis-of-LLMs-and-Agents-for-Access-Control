# /etc/security/pwquality.conf
#
# This file defines password quality requirements. Many of the additional
# policies (such as vendor default changes, account inactivity removal,
# repeated access lockouts, idle session reauthentication, password history,
# MFA enforcement, etc.) must be implemented via PAM modules, account policies,
# or other system configuration files. The settings below enforce the quality
# of new passwords.
#
# Relevant policy references:
# • Vendor-supplied default passwords/settings must be changed and unnecessary accounts disabled.
#   (See 2.1)
# • Inactive user accounts removed/disabled within 90 days.
#   (See 8.1.4)
# • Limit repeated access attempts by locking an account after not more than 6 failures.
#   (See 8.1.6)
# • Set lockout duration to at least 30 minutes or require administrator re-enablement.
#   (See 8.1.7)
# • Require reauthentication if a session is idle for over 15 minutes.
#   (See 8.1.8)
# • Enforce passwords/passphrases with a minimum length of 12 characters that include
#   both numeric and alphabetic characters.
#   (See 8.3.6)
# • (Legacy note: A minimum length of 7 characters is referenced in 8.2.3, but the stricter
#   minimum of 12 characters is enforced here.)
# • Require users to change passwords at least every 90 days.
#   (See 8.2.4)
# • Disallow reuse of any of the last 4 passwords/passphrases.
#   (See 8.2.5 and 8.3.7)
# • Force first-time or reset passwords to be unique and changed immediately after initial use.
#   (See 8.2.6)
# • Ensure that authentication methods (passwords, biometrics, smart cards, tokens) are encrypted.
#   (See 8.3.1)
# • Alternative invalid authentication settings: lock out after no more than 10 failures with a
#   lockout duration of at least 30 minutes until identity confirmation.
#   (See 8.3.4)
# • Mandate password changes if compromise is suspected.
#   (See 8.3.8)
# • Enforce and document MFA for all access to the CDE and remote access.
#   (See 8.4.1 to 8.5.1)
# • Prohibit hardcoding of passwords in scripts and require periodic password changes.
#   (See 8.6.2, 8.6.3)
# • For additional details, refer to: https://pages.nist.gov/800-63-4/sp800-63b.html
#
# The following settings relate to the password composition:
minlen = 12
# Require at least one numeric digit.
dcredit = -1
# Enforce use of at least two different character classes (for example, alphabetic and numeric).
minclass = 2
#
# Additional recommended settings:
# Limit sequences of identical characters (e.g., "aaa") to three in a row.
maxrepeat = 3
# Prevent the username from being used as part of the password.
reject_username = 1

# Note: Other account security measures such as account lockout rules, password aging,
# password history, session timeout, and multifactor authentication must be configured
# in the appropriate PAM and system configuration files.
