# /etc/security/pwquality.conf
#
# This configuration file is intended to support the following password policy rules:
#
# 1. Use MFA wherever possible.
#    (Note: MFA configuration is managed outside this file. Ensure MFA is enabled via your authentication modules.)
#
# 2. Minimum Password Length:
#    - For password‐only accounts: 14 characters.
#    - For MFA-enabled accounts: 8 characters.
#    NOTE: This file enforces the stricter criterion (14 characters). For MFA-enabled accounts, adjust the PAM
#    settings accordingly to permit a lower minimum.
minlen = 14
#
# 3. Maximum Password Length:
#    Do not enforce an upper limit here. The system constraints will apply.
#    (No “maxlen” setting is provided so that passwords are effectively unlimited.)
#
# 4. Character Composition:
#    Allow all character types but require at least one non‐alphabetic character for password‐only accounts.
#    The “ocredit” option set to -1 mandates at least one non-alphabetic (symbol) character.
ocredit = -1
#
# 5. Password Aging:
#    - In the event of a breach, enforce an immediate change.
#    - As a backstop, force password expiration annually.
maxdays = 365
#
# 6. Deny Lists and Password History:
#    - On new password creation, check against an internal deny list of known weak passwords (at least 20 common ones).
#    - Also verify that the new password does not match any of the previous 5 passwords.
#    "dictcheck" enables a dictionary check.
dictcheck = 1
# Specify the path to the deny list file (ensure this file contains your list of weak passwords)
dictpath = /etc/security/weak_passwords.txt
# Remember the last 5 passwords to prevent reuse:
remember = 5
#
# 7. Password Change Delay:
#    Enforce a minimum delay of one day between password changes.
#    (This setting is typically managed via PAM or /etc/login.defs. Not directly configurable in pwquality.conf.)
#    Example reminder: minage = 1
#
# 8. Session and Account Lockout Policies:
#    - Lock the current session after 15 minutes or less of inactivity.
#    - Implement a temporary account lockout (15 minutes or more) after five consecutive failed attempts.
#    - Apply exponential time doubling (0, 1, 2, 4, 8, … minutes) between each retry, with permanent lockout
#      after 12 retries (IT reset required).
#    - Monitor and alert key personnel when failed login attempts reach the defined limit.
#
#    These policies are managed by other PAM modules (such as pam_faillock) or system configuration and should be
#    configured in their respective files.
#    Example reminders:
#       faillock_threshold = 5
#       faillock_time = 900            (15 minutes in seconds)
#       faillock_doubling = yes
#       faillock_maximum = 12
#
# 9. Inactive Account Handling:
#    Automatically suspend the account after 45 days without a valid login.
#    (This is normally configured in your account management tools.)
#    Example reminder: account_suspend_days = 45
#
#10. Password Hints:
#    Do not allow user-defined password hints at login.
#    (This should be configured in the login manager or corresponding module.)
#
# Reference: NIST SP 800-63B – Digital Identity Guidelines
#
# END OF CONFIGURATION
