# /etc/security/pwquality.conf
#
# This file specifies password quality requirements for local accounts. Note that
# several policies outlined (MFA requirements, account lockout policies, session
# inactivity locking, password history, forced expiration, etc.) must be enforced
# by additional mechanisms such as PAM modules, account management scripts, or other
# system configurations.
#
# 1. MFA Usage (see 2.1)
#    • Use MFA wherever possible. (Enforced outside this file.)
#
# 2. Minimum Password Length (see 5.1.1)
#    • For password‐only accounts, require at least 14 characters.
#    • For MFA-enabled accounts, require at least 8 characters.
#
#  NOTE:
#    The pwquality module cannot conditionally apply different minimum lengths
#    based on MFA status. In this file, we define the stricter requirement for
#    password-only accounts. Ensure that MFA-enabled accounts are handled as exceptions
#    by your account management policies.
minlen = 14
#
# 3. Maximum Password Length (see 5.1.1)
#    • Passwords should be as long as system resources permit.
#    • Do not impose an artificial maximum length here.
#    (No maxlen parameter is specified.)
#
# 4. Character Type Requirements (see 5.1.2)
#    • Allow all character types.
#    • Require at least one non‐alphabetic character for password‐only accounts.
#
#  NOTE:
#    Since conditional requirements based on account type cannot be enforced in this
#    file, we set “dcredit” to require at least one digit (or other non‐alphabetic
#    character). Adjust additional credits if you wish to mandate punctuation, etc.
dcredit = -1
#
# 5. Password Change Enforcement (see 5.1.3)
#    • In the event of a breach, force an immediate password change,
#      with an annual expiration as a backstop.
#
#    NOTE:
#      Password expiration must be configured via PAM or system account settings.
#
# 6. Deny List and Password History (see 5.1.4)
#    • Check new passwords against a deny list of at least 20 common or weak passwords,
#      as well as reject reuse of the previous 5 passwords.
#
#    NOTE:
#      This check should be implemented using additional modules (e.g., pam_pwhistory)
#      and an internal bad-password/dictionary file. This file does not provide that functionality.
#
# 7. Password Change Delay (see 5.1.4)
#    • Enforce a minimum delay of one day before a user can change their password again.
#
#    NOTE:
#      This delay must be enforced outside of pwquality.
#
# 8. Session Locking (see 5.1.5)
#    • Lock the current session after 15 minutes (or less) of inactivity.
#
#    NOTE:
#      Session timeout is typically configured in desktop environment settings or via PAM.
#
# 9. Account Lockout and Throttling (see 5.1.6)
#    • Temporarily lock the account for at least 15 minutes after 5 consecutive failed logins.
#    • Implement exponential (time doubling) throttling between retries, with a permanent lockout
#      after 12 attempts (requiring an IT reset).
#
#    NOTE:
#      These settings must be configured in your PAM lockout (e.g., pam_tally2 or pam_faillock) modules.
#
# 10. Alerting on Failed Attempts (see 5.1.7)
#     • Monitor and alert key personnel when the number of failed logins reaches the defined limit.
#
#     NOTE:
#       This is typically handled via system security monitoring and alerting services.
#
# 11. Account Suspension for Inactivity (see 5.1.8)
#     • Automatically suspend an account after 45 days without a valid login.
#
#     NOTE:
#       Account suspension must be enforced via system account management policies.
#
# 12. Disallow Password Hints (see 5.1.9)
#     • Do not allow user-defined password hints at login.
#
#     NOTE:
#       This is enforced by the authentication mechanism and not by the pwquality module.
#
# For further guidance, refer to https://pages.nist.gov/800-63-4/sp800-63b.html
