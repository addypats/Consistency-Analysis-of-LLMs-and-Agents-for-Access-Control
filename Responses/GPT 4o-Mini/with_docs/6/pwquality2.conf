# /etc/security/pwquality.conf
# ---------------------------------------------------------------------------
# This configuration file is used by pam_pwquality. Note that several of the
# following policy rules are enforced elsewhere in the PAM stack or by separate
# system/account management tools. Refer to the related sections of your overall
# security policy for complete implementation details.
#
# 1. Multi-Factor Authentication (MFA)
#    - Use MFA wherever possible. (See Section 2.1)
#      [Note: MFA itself is not configured via pwquality; ensure PAM and related
#       services enforce MFA where applicable.]
#
# 2. Minimum Password Length
#    - For password‚Äêonly accounts: 14 characters.
#    - For MFA-enabled accounts: 8 characters.
#      Here, we set the general minimum length to 14. For MFA-enabled accounts,
#      a separate PAM configuration should allow a lower minimum (8 characters).
minlen = 14
#
# 3. Maximum Password Length
#    - No fixed maximum is enforced; password length is only limited by
#      system constraints. (See Section 5.1.1)
#      [Note: Do not set any parameter to restrict the maximum length.]
#
# 4. Composition Requirements
#    - Allow all character types.
#    - For password-only accounts, require at least one non-alphabetic (i.e. digit or symbol)
#      character. (See Section 5.1.2)
#      The ocredit option below forces at least one non-alphanumeric character.
ocredit = -1
#
# 5. Password Expiration and Change Policy
#    - In the event of a breach, force an immediate password change, with a maximum
#      annual expiration as a backstop. (See Section 5.1.3)
#      [Note: This is generally configured via account aging settings (e.g., /etc/shadow)
#       and external breach response processes.]
#
# 6. Deny List and History Enforcement
#    - When creating a new password, check against:
#         a) An internal deny list of known bad/weak passwords (at least 20 common passwords),
#         b) The user's last five passwords.
#      (See Section 5.1.4)
#      [Note: This is normally handled using a combination of pam_cracklib/pam_pwquality
#       (with an appropriate 'dictpath') and pam_pwhistory. Configure those modules as needed.]
#
# 7. Password Change Delay
#    - Enforce a minimum delay of one day between password changes.
#      (See Section 5.1.4)
#      [Note: This setting is typically managed via pam_unix or similar mechanisms.]
#
# 8. Session Inactivity Lock
#    - Lock the current session after 15 minutes (or less) of inactivity.
#      (See Section 5.1.5)
#      [Note: Session locking is usually configured in the desktop or terminal multiplexer,
#       not via pwquality.]
#
# 9. Temporary Account Lockout and Throttling
#    - Lock account temporarily (for 15 minutes or more) after five consecutive failed
#      login attempts.
#    - Implement time-doubling throttling (0, 1, 2, 4, 8, etc. minutes between retries)
#      with a permanent lockout (requiring IT reset) after 12 retries.
#      (See Section 5.1.6)
#      [Note: These rules need to be enforced using pam_faillock or a similar module.]
#
# 10. Alerting on Failed Login Attempts
#     - Monitor and alert key personnel when failed login attempts reach the designated limit.
#       (See Section 5.1.7)
#       [Note: This requires integration with system monitoring and alerting tools.]
#
# 11. Inactive Account Suspension
#     - Automatically suspend accounts after 45 days without a valid login.
#       (See Section 5.1.8)
#       [Note: This policy is enforced by account management procedures outside of pwquality.]
#
# 12. Password Hints
#     - Do not allow user-defined password hints at login.
#       (See Section 5.1.9)
#       [Note: This is a policy decision enforced in the authentication/login interface.]
#
# ---------------------------------------------------------------------------
# Additional pwquality settings (defaults or custom tweaks) can be placed below.
# For example, you might specify a custom dictionary path:
# dictpath = /usr/share/dict/passwords
#
# End of /etc/security/pwquality.conf
