# /etc/security/pwquality.conf
#
# This file enforces the following password policies. Note that some items (MFA,
# session locking, account lockout, password history, expiration, etc.) must be
# implemented in other parts of the system (e.g. PAM, login manager, account
# management tools) and are noted here for reference.
#
# 1. Multi-factor Authentication (MFA)
#    • Use MFA wherever possible.
#    (MFA configuration is handled separately from pwquality settings.)
#
# 2. Password Length
#    • For password‐only accounts, require a minimum length of 14 characters.
#    • For MFA‐enabled accounts, a minimum of 8 characters is acceptable.
#      This file applies the stricter policy by default; MFA-enabled
#      configurations can override this minimum where appropriate.
minlen = 14
#
# 3. Maximum Password Length
#    • No maximum length is imposed here; passwords may be as long as system
#      constraints allow.
#
# 4. Character Composition
#    • Allow all character types.
#    • For password‐only accounts, require at least one non‐alphabetic character.
#      Enforcing a minimum variety of character classes helps ensure this
#      condition. By requiring use of at least three of the following four
#      classes (lowercase, uppercase, digits, other) we prevent a password from
#      consisting solely of alphabetic characters.
minclass = 3
#
# 5. Password Expiration and Breach Response
#    • In the event of a breach, require an immediate password change.
#    • Enforce an annual expiration as a backstop.
#      (Actual expiration settings are managed in /etc/shadow or via PAM modules.)
#
# 6. Deny List and Password History
#    • On new password creation, check against an internal deny list of common
#      weak passwords (at least 20 known examples) and ensure that none of the
#      previous 5 passwords are reused.
#      (Dictionary checks and password history are typically enforced via modules
#      such as pam_cracklib and pam_unix; enabling dictionary verification here.)
dictcheck = 1
#
# 7. Minimum Time Between Password Changes
#    • Enforce a delay of at least one day before a password change can be accepted.
#      (This delay is normally set within the PAM or account policy configuration.)
#
# 8. Session and Account Lockout Policies
#    • Lock the current session after 15 minutes (or less) of inactivity.
#    • Trigger a temporary account lockout (15 minutes or more) after five consecutive
#      failed login attempts.
#    • Apply time-doubling throttling between retries, culminating in a permanent
#      lockout (requiring an IT reset) after 12 consecutive failures.
#    • Monitor and alert key personnel when bad login attempts reach the threshold.
#      (These measures are implemented through session management and login security
#      components rather than pwquality.conf.)
#
# 9. Automatic Account Suspension
#    • Automatically suspend an account after 45 days without a valid login.
#      (This is handled by account management policies outside of pwquality.)
#
# 10. Password Hints
#     • Do not allow user-defined password hints at login.
#       (This is configured in the authentication interface, not in this file.)
#
# Reference: https://pages.nist.gov/800-63-4/sp800-63b.html

# End of /etc/security/pwquality.conf
