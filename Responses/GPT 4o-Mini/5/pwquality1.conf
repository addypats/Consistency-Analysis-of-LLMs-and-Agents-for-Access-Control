# /etc/security/pwquality.conf
#
# NOTE: This file only governs the complexity and composition of passwords.
# Other account and session security settings (e.g. vendor defaults, account
# inactivation, repeated access lockout, idle session re-authentication, MFA,
# password history and expiration policies) MUST be implemented via other
# system mechanisms and PAM modules.
#
# Rule 1: Always change vendor-supplied defaults and remove/disable any unnecessary accounts.
#         (Implement outside of this file.)
#
# Rule 2: Remove/disable inactive user accounts within 90 days.
#         (Implement outside of this file.)
#
# Rule 3 & 11: Limit repeated authentication attempts by locking out the user ID
#         after not more than six (or ten, per alternative rule) attempts, with a
#         lockout duration of at least 30 minutes or until an administrator intervenes.
#         (Implement via modules such as pam_tally2 or pam_faillock.)
#
# Rule 4: Require re-authentication if a session idles for more than 15 minutes.
#         (Configure via session management tools, not via pwquality.)
#
# Rule 5 & 7: Enforce a minimum password length. Although one rule requires at least
#         7 characters, the stronger requirement mandates at least 12 characters.
minlen = 12
#
# Rule 6 & 8: Passwords/passphrases must contain both numeric and alphabetic characters.
#         Here we require at least one digit and enforce that the password contains at least
#         two character classes. Note: This does not guarantee letters only; ensure that
#         PAM history or custom checks enforce that the non-digit characters are alphabetic.
dcredit = -1
minclass = 2
#
# Rule 9: Change user passwords at least every 90 days.
#         (This policy is implemented via password aging settings in /etc/shadow or PAM.)
#
# Rule 10 & 12: Do not allow reuse of any of the last four passwords.
#         (Enforce via pam_pwhistory or equivalent; not configurable in pwquality.)
#
# Rule 13: Set passwords for first-time use or reset to a unique value and force change
#         upon first login.
#         (This requires administrative procedures and/or PAM configuration.)
#
# Rule 14: Authenticate access using approved methods and ensure encryption.
#         (Not applicable in pwquality.conf; configure via PAM and encryption settings.)
#
# Rule 15 & 16: Invalidate and limit authentication attempts, and require password change
#         if compromise is suspected.
#         (These policies are to be implemented via audit, account lockout, and PAM modules.)
#
# Rule 17: Implement and enforce MFA for all access.
#         (MFA is not managed via pwquality.conf; see relevant system/PAM configuration.)
#
# Rule 18: Ensure passwords are not hardcoded and are periodically changed.
#         (This is a procedural requirement and not configurable here.)
#
# End of pwquality settings

# Ensure that usernames are not incorporated in the password
reject_username = 1

# Optionally, enable dictionary check if a suitable wordlist is available.
# dictcheck = 1

# The following options may be available on some systems:
# (Uncomment and tailor as needed)
# enforce_for_root = 1

# End of file
