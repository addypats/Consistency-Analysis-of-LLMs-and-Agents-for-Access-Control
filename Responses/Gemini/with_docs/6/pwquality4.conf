```
# This file configures the pam_pwquality module, which is part of the pam_cracklib package.
# It enforces password quality rules.
#
# NOTE: Many of the requested rules (MFA, session locking, account lockout,
# password expiration, account suspension, logging, etc.) are handled by
# other system components like PAM modules (e.g., pam_faillock, pam_unix),
# /etc/login.defs, desktop environment settings, or monitoring solutions,
# and cannot be configured directly within pwquality.conf.
# This file configures only the password *quality* checks.

# Use MFA wherever possible (see 2.1):
# This file does not configure MFA directly. MFA is set up via PAM modules
# (e.g., pam_google_authenticator, pam_u2f) in /etc/pam.d/* files.
# The following password length rules differentiate between password-only
# and MFA-enabled accounts, but pwquality.conf applies globally.
# For MFA-enabled accounts to have different password requirements,
# a distinct PAM configuration (e.g., in a separate service or using conditional
# logic within a PAM stack) might be necessary to apply different pwquality
# settings for those users. This file will use the stricter "password-only"
# settings as default.

# Require a minimum length of 14 characters for password-only accounts.
# For MFA-enabled accounts, a minimum length of 8 characters is requested.
# As pwquality.conf applies globally, we set the stricter requirement of 14 characters.
# To allow 8 characters for MFA-enabled accounts, a separate PAM stack
# configuration would be needed.
minlen = 14

# Maximum password length should be as long as possible based on system constraints.
# Do not limit the maximum length of passwords (see 5.1.1).
# Setting maxlen to -1 means no maximum length is enforced by this module.
maxlen = -1

# Allow all character types in a password (default behavior).
# Require at least one non-alphabetic character for password-only accounts (see 5.1.2).
# To enforce "at least one non-alphabetic character" (e.g., digit or special character),
# we require a minimum of 3 character classes (lowercase, uppercase, digits, others).
# This ensures a mix, and typically includes a non-alphabetic character.
# For example, "Password123" (lowercase, uppercase, digit) or "Password!" (lowercase, uppercase, special).
# Passwords like "Passwordpassword" (lowercase, uppercase) would not pass minclass=3.
minclass = 3
# lcredit = 0  # no specific requirement for lowercase count (implicit in minclass)
# ucredit = 0  # no specific requirement for uppercase count (implicit in minclass)
# dcredit = 0  # no specific requirement for digit count (implicit in minclass)
# ocredit = 0  # no specific requirement for other character count (implicit in minclass)

# Change the password immediately in the event of a breach, with an annual expiration as a backstop (see 5.1.3).
# Password expiration is not handled by pwquality.conf. It's configured in:
# - /etc/login.defs: PASS_MAX_DAYS (e.g., PASS_MAX_DAYS 365 for annual expiration)
# - PAM modules: pam_unix.so (often implicitly relies on login.defs)
# Immediate password change on breach is a procedural and administrative action.

# Check on new password creation against an internal deny list of known bad, weak
# (Of at least 20 common passwords), or previous 5 passwords (see 5.1.4).
# Check against an internal deny list:
# This requires a file containing common, weak, or breached passwords, one per line.
# The administrator must create and maintain this file.
badwords = /etc/security/pwquality_bad_passwords.txt
# Check against previous 5 passwords:
# This ensures the new password is sufficiently different from the last 5 used passwords.
difok = 5

# Enforce a password change delay of at least one day (see 5.1.4).
# This is typically configured in /etc/login.defs:
# - PASS_MIN_DAYS 1 (prevents users from changing their password again for at least 1 day).

# Lock current session after 15 minutes (or less) of inactivity (see 5.1.5).
# This is usually handled by:
# - Desktop Environment settings (screensaver lock)
# - Shell settings (e.g., TMOUT variable in /etc/profile or .bashrc for terminal sessions).
# - systemd settings for TTYs.
# This is not a pwquality.conf setting.

# Temporary account lockout (15 minutes or more) after five consecutive failed attempts (see 5.1.6).
# Time doubling throttling (in minutes) between each retry (0, 1, 2, 4, 8, etc.)
# with a permanent account lockout (IT reset required) after 12 retries (see 5.1.6).
# This is handled by PAM modules, typically pam_faillock.so, configured in files like
# /etc/pam.d/system-auth and /etc/pam.d/password-auth.
# Example pam_faillock configuration (in auth section):
# auth required pam_faillock.so preauth audit deny=5 unlock_time=900
# auth [success=1 default=bad] pam_unix.so
# auth required pam_faillock.so postauth audit deny=5 unlock_time=900
#
# For the time doubling throttling and permanent lockout after 12 retries:
# pam_faillock supports 'deny=12' for the maximum attempts.
# The 'unlock_time' parameter can be set to a very high value (e.g., 2592000 for 30 days)
# to simulate a "permanent" lockout that requires manual intervention (faillock --reset).
# Exact doubling throttling (0, 1, 2, 4, 8...) might require a custom PAM module or
# external script integrated with PAM, as pam_faillock primarily uses a fixed 'delay'
# or 'unlock_time' rather than a progressive doubling interval.

# Monitor and alert key personnel when the above bad login attempts reach the login limit (see 5.1.7).
# This involves system logging (e.g., syslog, journald) and a monitoring solution
# (e.g., SIEM, log management system with alerting capabilities) that parses authentication logs.
# This is not a pwquality.conf setting.

# Automatically suspend the account after 45 days without a valid login (see 5.1.8).
# This is managed by account inactivity settings, usually via:
# - /etc/login.defs: INACTIVE (e.g., INACTIVE 45) which is applied to new users.
# - The 'chage' command: `chage -I 45 <username>` to set inactivity period for existing users.
# This is not a pwquality.conf setting.

# Do not allow user-defined password "hints" at login (see 5.1.9).
# This is generally a feature that should be disabled or not enabled in Identity and
# Access Management (IAM) systems or specific applications. Operating systems
# typically do not offer password hints at login by default.
# This is not a pwquality.conf setting.

# Other common pwquality parameters (not explicitly requested but good to be aware of):
# retry = 3           # Allow up to 3 retries if password check fails.
# maxrepeat = 0       # Maximum number of allowed consecutive same characters (0 means no limit unless specified by credit params).
# maxsequence = 0     # Maximum number of allowed characters in a sequence (e.g., "abc", "123"). 0 means no limit.
# enforce_for_root    # Enforce quality rules for root user (default is 'no' for safety, but recommended 'yes' in secure environments).
# dictpath =          # Path to the dictionary file for cracklib, if used.
```