# NIST SP 800-63B based password quality rules for /etc/security/pwquality.conf

# This file configures the `pwquality.so` PAM module, which primarily checks password
# composition and strength during creation or change.
# Many of the NIST SP 800-63B rules (e.g., MFA, password expiration, account lockout,
# session locking, monitoring, account suspension, password change delay, and
# password history) are handled by other PAM modules, `/etc/login.defs`,
# display managers, system services, or operational processes, and are
# outside the scope of `pwquality.conf`.

# 5.1.1 Require a minimum length of 14 characters for password-only accounts.
# (Note: `pwquality.conf` cannot differentiate between password-only and MFA-enabled
# accounts. The strictest requirement (14 characters) is applied here globally.
# For MFA-enabled accounts requiring an 8-character minimum, a separate PAM
# configuration or application-level logic would be needed to bypass or override
# this `pwquality` setting.)
minlen = 14

# 5.1.1 Do not limit the maximum length of passwords.
# A value of 0 means no maximum length, allowing users to choose very long passwords.
maxlen = 0

# 5.1.2 Allow all character types in a password and require at least one
# non-alphabetic character for password-only accounts.
# `minclass = 2` ensures that the password contains characters from at least two
# of the four character classes (lowercase, uppercase, digits, other).
# This effectively enforces the requirement for at least one non-alphabetic
# character when combined with alphabetic characters.
# (NIST 800-63B generally recommends against explicit composition rules for new passwords,
# but this rule is included as per the specific user request.)
minclass = 2

# 5.1.4 Check on new password creation against an internal deny list of
# known bad or weak passwords (e.g., at least 20 common passwords).
# The specified file must be created and maintained by the system administrator,
# with each blacklisted word on a new line.
badwords = /etc/security/pwquality-bad-passwords.txt

# --- Additional common parameters (not explicitly requested to be changed from defaults
#     but often considered for a robust policy) ---

# Minimum number of characters that must not be present in the old password.
# This helps prevent simple password variations (e.g., appending a number).
# It does *not* enforce a "previous 5 passwords" history; that's typically
# handled by PAM modules like `pam_unix.so` with `remember` or `pam_pwhistory.so`.
# Setting this to 5 is a common practice to prevent reusing very similar passwords.
# difok = 5

# Ensure password is not a simple dictionary word. Requires `cracklib-dicts` package.
# dictcheck = 1