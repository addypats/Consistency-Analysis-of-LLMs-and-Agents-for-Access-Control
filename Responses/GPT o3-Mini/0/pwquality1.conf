# /etc/security/pwquality.conf
#
# Note: pwquality enforces password composition/strength at set/change time.
# Password aging (90 days) and history (no reuse for 1 year) are enforced via
# other PAM/account settings (see comments at bottom).

minlen = 10

# Require at least one character from each class:
# - alpha (credit)
# - digit
# - special
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = -1

# Reject passwords containing the username (or parts of it) and enforce GECOS checks
usercheck = 1
gecoscheck = 1

# Prevent simple/dictionary-based passwords (uses cracklib dictionary if available)
dictcheck = 1

# Reasonable minimum for number of character changes vs old password
difok = 4

# Enforce for privileged users too
enforce_for_root

#
# Not enforced by pwquality.conf (configure elsewhere):
# - Change every 90 days: set PASS_MAX_DAYS 90 in /etc/login.defs and/or use `chage -M 90 USER`
# - No reuse for 1 year: configure PAM password history (pam_pwhistory.so or pam_unix.so remember=...)
#   Example (distribution-dependent): remember=12 (approx monthly changes for 1 year)