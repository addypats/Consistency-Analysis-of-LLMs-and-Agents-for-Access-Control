# /etc/security/pwquality.conf
#
# Enforce strong password complexity/quality.
# NOTE: Password aging (90 days) and password history (no reuse for 1 year)
# are not enforced by pwquality.conf; configure those in /etc/login.defs
# and PAM (e.g., pam_unix.so remember=..., or pam_pwhistory.so) respectively.

# Minimum length
minlen = 10

# Require character classes: alpha + numeric + special
# (pwquality treats "special" as non-alphanumeric)
ucredit = -1
lcredit = -1
dcredit = -1
ocredit = -1

# Prevent passwords tied to the user/account name
usercheck = 1
gecoscheck = 1

# Reject dictionary words (requires pwquality/libcrack dictionary to be installed)
dictcheck = 1

# Require at least 3 character changes from the old password
difok = 3

# Do not allow simplistic sequences/repeats
maxrepeat = 2
maxsequence = 3

# Require complexity for the whole password, not just added characters
enforce_for_root = 1