# /etc/security/pwquality.conf
#
# NOTE: pwquality.conf only controls password quality/complexity.
# Requirements for lockout, idle timeout, password aging/history, MFA,
# disabling default/inactive accounts, and hardcoded password controls
# must be enforced via PAM (e.g., pam_faillock, pam_unix, pam_pwhistory),
# login/session settings (TMOUT, systemd-logind), account management, and
# application/SSH/VPN policies.

# Minimum password length (>=12)
minlen = 12

# Require at least one digit and at least one letter
dcredit = -1
ucredit = 0
lcredit = 0

# Ensure at least one alpha by requiring at least one lower OR upper
# (if you want stricter, set ucredit = -1 and lcredit = -1)
lcredit = -1

# Require at least 2 distinct character classes (enforces alpha+digit given above)
minclass = 2

# Reject passwords with too many repeated characters
maxrepeat = 3
maxclassrepeat = 4

# Require some difference from the old password when changing
difok = 4

# Disable simplistic checks based on username/GECOS
usercheck = 1
gecoscheck = 1

# Enforce checks for privileged accounts too
enforce_for_root

# Keep defaults for dictionary/path checks; enable if dictionaries are installed
# dictcheck = 1
# dictpath = /usr/share/dict/words