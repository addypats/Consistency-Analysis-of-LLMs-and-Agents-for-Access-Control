# /etc/security/pwquality.conf
#
# NOTE:
# This file controls ONLY password quality requirements enforced by libpwquality/PAM.
# Items in the request related to account lockout, lockout duration, idle session timeout,
# password history, password aging, vendor defaults, inactive accounts, MFA, encryption,
# and hardcoded passwords are NOT configurable in pwquality.conf and must be handled via
# PAM (pam_faillock), login.defs/chage, pam_pwhistory, TMOUT/autologout, MFA modules, etc.

# Enforce minimum length (>=12)
minlen = 12

# Require both alphabetic and numeric characters:
# At least 1 digit and at least 1 letter (use "credit" style requirements)
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = 0

# Require at least 1 character class in addition to the others (keeps policy robust)
minclass = 2

# Prevent overly simple passwords
difok = 4

# Disallow passwords containing the username (or reversed username)
usercheck = 1

# Reject passwords that match dictionary words / common passwords (when cracklib is available)
dictcheck = 1

# Enforce checks even for the root user
enforce_for_root = 1

# Allow a limited number of retries during password change
retry = 3

# Do not accept passwords shorter than minlen even if "credits" would reduce length
# (libpwquality default behavior already enforces minlen; keep credits at 0 except digit)
# (no setting required)