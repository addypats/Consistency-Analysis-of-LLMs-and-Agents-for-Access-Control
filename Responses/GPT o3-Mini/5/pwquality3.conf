# /etc/security/pwquality.conf
#
# NOTE: This file only controls password *quality* checks via libpwquality.
# Requirements for account lockout, password aging/history, MFA, idle session
# timeout, default/vendor accounts, and hardcoded passwords are enforced via
# PAM, login.defs/chage, faillock/tally2, tmout/screen/sshd, and other controls.

# Minimum password length (must be at least 12 per policy)
minlen = 12

# Require at least one digit and at least one letter (enforced via credits)
dcredit = -1
ucredit = 0
lcredit = 0

# Require at least 2 character classes overall (letters + digits satisfies this)
minclass = 2

# Disallow passwords containing the username (basic similarity check)
usercheck = 1

# Reject passwords that are too similar to the old password
difok = 4

# Enforce checks for the root user as well
enforce_for_root

# Reject simplistic/sequence-style passwords more aggressively
maxrepeat = 2
maxclassrepeat = 3
gecoscheck = 1
dictcheck = 1

# Retry count for interactive password setting
retry = 3