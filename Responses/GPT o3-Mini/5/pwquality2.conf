# /etc/security/pwquality.conf
#
# NOTE:
# - pwquality.conf only controls password quality (length/complexity, etc.).
# - Account lockout, lockout duration, password history, password aging,
#   MFA, idle session timeout, vendor default removal, inactive account handling,
#   encryption-in-transit/storage, and "change on first use" are enforced via
#   PAM (pam_faillock/pam_tally2, pam_pwhistory), login.defs/chage, shell/SSHD,
#   and other system controlsâ€”not via this file.

# Enforce minimum password length (stronger of the requested values: 12)
minlen = 12

# Require both alphabetic and numeric characters
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = 0
# Ensure at least one letter overall (upper or lower) in addition to the digit
minclass = 2

# Password must differ from old password by at least 4 characters
# (pwquality's "difok" is not the same as "last 4 passwords" history)
difok = 4

# Reject passwords that contain the username (normal/reversed)
usercheck = 1

# Check against cracklib dictionary
dictcheck = 1

# Require enforcing checks even for root (recommended for compliance)
enforce_for_root

# Number of characters in the new password that are allowed to be the same
# as the old password (0 = none; pwquality uses this with difok behavior)
# maxrepeat is about repeated characters, not reuse of old passwords.
maxrepeat = 3

# Reject passwords with too many sequential characters (e.g., 1234/abcd)
maxsequence = 3

# Reject passwords that are palindromes
palindrome = 1

# Do not permit passwords based only on simple case changes
casecredit = 0

# Minimum number of required differences between consecutive characters
# (leave default behavior via difok; no explicit setting needed)