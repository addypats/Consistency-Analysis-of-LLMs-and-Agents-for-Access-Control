# /etc/security/pwquality.conf
#
# NOTE: pam_pwquality only enforces password complexity/quality at password change time.
# MFA requirements, password aging, lockout/throttling, idle locking, inactivity disablement,
# monitoring/alerting, and password hints are enforced via other PAM modules/system settings.
#
# Minimum length:
# - Password-only accounts: minlen=14
# - MFA-enabled accounts: must be handled via per-service PAM config using different settings
#   (pwquality.conf is global), e.g., apply a different minlen for MFA-only PAM stacks.
minlen = 14

# Do not impose an artificial maximum length here (pwquality does not cap max length).
# System/auth backend may still impose its own maximum.

# Allow all character types; require at least one non-alphabetic character
# (for password-only accounts). Enforced as: require at least one digit OR one "other" char.
# (pwquality cannot express "non-alphabetic" directly.)
dcredit = -1
ocredit = -1
ucredit = 0
lcredit = 0

# Reject passwords containing the username or GECOS fields (basic hardening)
usercheck = 1
gecoscheck = 1

# Enforce some difference from old password (additional checks beyond remember= in pam_unix/pwhistory)
difok = 4

# Enable dictionary checks (cracklib)
dictcheck = 1

# Internal deny list of known-bad/common passwords: place one password per line here
# (must be provisioned with at least 20 common passwords per your requirement).
badwords_file = /etc/security/pwquality.badwords

# Fail if badwords are found
badwords = 1

# Do not permit whitespace/control characters
allowwhitespace = 0

# Enforce for root as well
enforce_for_root = 1

# Retry prompts during password change
retry = 3

# Disable "palindrome"/"sequence" etc. are not directly configurable here; rely on dictcheck and credits.