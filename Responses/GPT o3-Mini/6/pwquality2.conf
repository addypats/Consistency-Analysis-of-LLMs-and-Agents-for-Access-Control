# /etc/security/pwquality.conf
#
# Note: pwquality.conf enforces password composition/quality only.
# MFA requirements, password aging, password history/denylist integration,
# lockout/throttling, inactivity locking/suspension, monitoring/alerting,
# and password hints are handled via PAM/SSSD/faillock/login.defs/systemd/etc.

# Minimum length:
# - Set to 14 for password-only accounts. (For MFA-enabled accounts, enforce 8 via
#   a separate PAM service stack or conditional rules; pwquality.conf is global.)
minlen = 14

# Do not impose a maximum password length here (leave unset).

# Allow all character types (no class restrictions), but require at least one
# non-alphabetic character for password-only accounts:
# Require at least 1 digit OR 1 "other" (symbol/punct/space) (either satisfies).
dcredit = -1
ocredit = -1
ucredit = 0
lcredit = 0

# Basic sanity checks
difok = 5
maxrepeat = 3
maxclassrepeat = 4

# Enable dictionary check if supported
dictcheck = 1

# Make checks enforceable (not just warnings)
enforcing = 1

# Root password quality enforcement (set to 1 to enforce for root too)
enforce_for_root = 1