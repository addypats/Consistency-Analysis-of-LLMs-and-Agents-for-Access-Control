# /etc/security/pwquality.conf
#
# Note: pwquality enforces password complexity/quality only.
# MFA requirements, expiration, lockout/throttling, session locking, inactivity
# suspension, alerts, and password hints are configured elsewhere (PAM, login.defs,
# faillock, systemd-logind, sshd, etc.).

# Minimum length (set to 14 for password-only accounts; use PAM stacking/conditions
# to relax to 8 for MFA-enabled accounts where applicable)
minlen = 14

# Do not cap maximum length here (0 = disable max length check in libpwquality)
maxlen = 0

# Allow all character types; require at least one non-alphabetic character
# (credit for digits/other, but requirement met via minclass below)
dcredit = -1
ocredit = -1

# Require at least 2 character classes (letters + at least one non-alphabetic)
minclass = 2

# Do not require specific counts of uppercase/lowercase (allow but not force)
ucredit = 0
lcredit = 0

# Avoid simplistic passwords derived from username/gecos
usercheck = 1
gecoscheck = 1

# Enforce similarity/difference constraints
difok = 4

# Enable "bad words" check; point to an internal denylist file (create/maintain separately)
dictcheck = 1
badwords_file = /etc/security/pwquality_badwords.txt

# Additional hardening
maxrepeat = 3
maxclassrepeat = 4
retry = 3
enforcing = 1