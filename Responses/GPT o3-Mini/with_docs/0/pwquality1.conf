# /etc/security/pwquality.conf
#
# Password quality policy (pam_pwquality).
# Note: password aging (90 days) and history (1 year / 4 previous at 90-day maxage)
# are enforced via /etc/login.defs and PAM (pam_unix/pwhistory), not pwquality.conf.

# Minimum password length
minlen = 10

# Require at least one of each character class:
#  - lowercase (lcredit = -1)
#  - uppercase (ucredit = -1)
#  - digit    (dcredit = -1)
#  - special  (ocredit = -1)
lcredit = -1
ucredit = -1
dcredit = -1
ocredit = -1

# Reject passwords containing the user name (or parts of it) and enforce minimum
# difference from the username.
usercheck = 1
difok = 4

# Complexity checks
minclass = 4
maxrepeat = 2
maxsequence = 3

# Dictionary checking (requires cracklib dictionaries installed)
dictcheck = 1

# Enforce for root as well
enforce_for_root

# Extra characters allowed as "special" (besides defaults)
# (pwquality also treats any non-alnum as special)
# NOTE: the following line is not supported on all pwquality versions; remove if it errors.
# local_users_only = 0