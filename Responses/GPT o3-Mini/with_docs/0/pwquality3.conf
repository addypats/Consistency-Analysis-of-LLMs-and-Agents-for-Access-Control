# /etc/security/pwquality.conf
# Enforce password complexity/quality. (Aging and reuse rules are configured
# via login.defs/chage and pam_pwhistory, not in pwquality.conf.)
# Reference: https://pages.nist.gov/800-63-4/sp800-63b.html

# Minimum length
minlen = 10

# Require character class variety (alpha, numeric, special)
# (at least 1 digit, 1 uppercase, 1 lowercase, 1 other/special)
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Disallow simplistic patterns and weak passwords
difok = 4
maxrepeat = 3
maxsequence = 3

# Prevent passwords tied to the account owner
usercheck = 1
gecoscheck = 1

# Reject dictionary words / obvious matches (requires cracklib dictionaries installed)
dictcheck = 1

# Enforce for root as well
enforce_for_root = 1

# Fail after this many attempts
retry = 3