# /etc/security/pwquality.conf
#
# NOTE:
# This file only controls password *quality* checks via libpwquality (length,
# character classes, etc.). Requirements such as lockout attempts/duration,
# password aging (90 days), password history (last 4), MFA, idle session timeout,
# disabling inactive accounts, and changing vendor defaults are enforced via
# PAM, login.defs, faillock/tally2, pwhistory/remember, systemd-logind, and
# account management processesâ€”not via pwquality.conf.

# Enforce minimum password length (PCI/NIST-aligned baseline)
minlen = 12

# Require both alphabetic and numeric characters
# (at least 1 digit and at least 1 letter)
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = 0

# Ensure at least one alphabetic character (upper or lower)
minclass = 2

# Reject passwords that are the same as (or derived from) the username
usercheck = 1

# Reject passwords containing parts of the GECOS field (real name, etc.)
gecoscheck = 1

# Require some complexity relative to the old password when changing it
difok = 4

# Do not allow overly simple repeated characters (e.g., "aaaaaaaa", "11111111")
maxrepeat = 3
maxclassrepeat = 4

# Enable dictionary checks (requires cracklib dictionaries on many distros)
dictcheck = 1

# Be stricter about sequences like "abcd" or "1234"
maxsequence = 3

# Disable checking against /etc/passwd as a dictionary (can be enabled if desired)
# local_users_only = 1