# /etc/security/pwquality.conf
#
# Enforces password composition/quality rules. Note:
# - Account lockout, session idle timeout, password aging/history, MFA, and
#   vendor/default account handling are enforced via PAM, login.defs, shadow,
#   faillock, TMOUT, and MFA tooling (not via pwquality.conf).

# Minimum password length (>=12 per 8.3.6; supersedes 7-char guidance in 8.2.3)
minlen = 12

# Require both alphabetic and numeric characters
# (negative values mean "at least N" of that class)
dcredit = -1   # at least 1 digit
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 2   # at least two character classes overall

# Basic anti-triviality checks
difok = 4
maxrepeat = 3
maxclassrepeat = 4
gecoscheck = 1
dictcheck = 1

# Apply to all users, including root
enforce_for_root

# Don't allow empty passwords
nullok = 0

# Provide errors to user (interactive feedback)
retry = 3