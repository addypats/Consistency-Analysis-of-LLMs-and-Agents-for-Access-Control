# /etc/security/pwquality.conf
#
# NOTE:
# - pam_pwquality only enforces password composition/quality at change time.
# - Lockout (failed attempts), session idle timeout, password aging, password history,
#   default account handling, MFA, and encryption-in-transit/at-rest are NOT controlled
#   by pwquality.conf (they are handled via PAM stack modules like pam_faillock,
#   pam_lastlog/pam_time, pam_pwhistory, and via /etc/login.defs, systemd-logind,
#   SSHD, application policy, etc.).

# Require minimum length 12
minlen = 12

# Require at least one digit
dcredit = -1

# Require at least one letter (upper or lower)
ucredit = 0
lcredit = 0
minclass = 2

# Reject passwords containing the username (or its reverse)
usercheck = 1

# Reject based on dictionary checks (requires libpwquality dictionaries)
dictcheck = 1

# Require a minimum number of changed characters between old/new passwords
difok = 4

# Disallow using the same password as the old one
no_same_password = 1

# Enforce for root as well
enforce_for_root = 1

# Number of generated passphrase words (only relevant if using pwquality's generator)
# (left default/unset)
# passphrase = 0