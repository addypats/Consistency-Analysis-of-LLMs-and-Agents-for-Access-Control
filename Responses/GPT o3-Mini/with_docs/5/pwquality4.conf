# /etc/security/pwquality.conf
#
# NOTE:
# - This file enforces *password quality* only (length/complexity checks).
# - Requirements like lockout after N attempts, lockout duration, idle timeout,
#   password aging (90 days), password history (last 4), MFA, hardcoded passwords,
#   disabling default/inactive accounts, and encrypted auth transmission/storage
#   are configured via PAM, login.defs, faillock, tmout, sshd, SSSD/IdM/AD, etc.,
#   not via pwquality.conf.

# Enforce minimum password length (>= 12)
minlen = 12

# Require both alphabetic and numeric characters:
# - at least 1 digit
# - at least 1 letter (either upper or lower)
dcredit = -1
ucredit = 0
lcredit = 0

# Also require at least one of upper/lower by setting one of them to -1
# while keeping the other at 0 would require at least one upper.
# Instead, ensure at least one letter in total using a class requirement:
# (pwquality doesn't have "alpha" directly, so require at least one lower OR one upper
# by requiring at least one lower; if you want either case accepted, keep both at 0
# and use class requirement below.)
lcredit = -1

# Require at least 2 character classes total (e.g., letters + digits)
minclass = 2

# Disallow trivial/weak choices
difok = 4
maxrepeat = 2
maxsequence = 3

# Enforce checks for the root account as well
enforce_for_root

# Reject passwords containing the username (where supported by the module)
usercheck = 1

# Check against system dictionaries (if installed/configured)
dictcheck = 1