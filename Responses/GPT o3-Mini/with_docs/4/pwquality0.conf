# /etc/security/pwquality.conf
#
# NIST SP 800-63B/63B-4 aligned baseline:
# - Minimum length 8 for user-chosen passwords
# - No additional composition requirements (no class/credit requirements)
# - Allow long passphrases (do not truncate); permit up to 64+ characters
# - Blacklist checking should be handled via PAM (e.g., pam_pwhistory/pam_faillock)
#
# NOTE: libpwquality enforces only some of NIST's requirements. Rate limiting,
# breach/blacklist checks, and Unicode normalization must be implemented in PAM
# and/or the application layer, not here.

minlen = 8

# Do not impose composition rules
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 0

# Do not require differences from old password here (policy handled elsewhere)
difok = 0

# Disable checks that reject based on patterns/sequence/repetition
maxrepeat = 0
maxsequence = 0
maxclassrepeat = 0

# Do not reject dictionary words here (use external compromised-password blacklist instead)
dictcheck = 0

# Do not reject passwords containing the username (NIST discourages arbitrary composition rules)
usercheck = 0

# Enforce policy strictly (fail rather than warn)
enforcing = 1

# Permit long passphrases (pwquality max is 100000; set to >=64 per NIST guidance)
maxlength = 100000

# Optional: do not require root to follow pwquality (set to 1 to enforce for root too)
enforce_for_root = 0