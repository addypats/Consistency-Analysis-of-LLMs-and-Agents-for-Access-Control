# /etc/security/pwquality.conf
#
# NIST SP 800-63B-aligned password quality settings (as supported by libpwquality).
# Notes:
# - pwquality cannot enforce MFA/risk-based authentication, prevent password hints,
#   or directly check breached-password lists; those must be handled by other systems.

# Minimum length: at least 8; encourage 15+
minlen = 8
# Encourage longer passwords by not requiring character-class complexity.
minclass = 0
# Give extra credit for length; avoid forcing predictable substitutions.
lencredit = 0

# Disallow obvious weaknesses (common words, sequences, repeated chars)
dictcheck = 1
usercheck = 1
gecoscheck = 1
maxrepeat = 3
maxsequence = 3
# Avoid palindromes (often weak); keep enabled unless you have compatibility needs.
palindrome = 1

# Do not require special characters / mixed classes (composition rules not required)
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Allow long passphrases (up to 64 characters)
maxlen = 64

# Fail immediately with a clear reason
retry = 1
enforcing = 1

# Set a minimum "quality" requirement (kept moderate since we favor length)
minquality = 40

# Optional: disable substring checking if it causes false rejects for passphrases
# substring = 0

# NOTE: Screening against known-breached passwords requires additional tooling
# (e.g., PAM module like pam_pwned, external check, or directory policy).