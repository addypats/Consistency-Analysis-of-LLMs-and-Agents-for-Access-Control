# /etc/security/pwquality.conf
#
# NIST-aligned baseline: encourage long passphrases, avoid mandatory composition,
# and block weak/compromised passwords. MFA/risk-based auth is enforced outside
# of pwquality (PAM/auth stack), not in this file.

# Minimum length: must be >= 8; encourage >= 15 (set minlen to 15 here).
minlen = 15

# Allow long passphrases (pam_pwquality supports up to 1023; this aligns with 64+ guidance).
maxrepeat = 3

# Do not require character class "complexity"
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 0

# Detect obvious weaknesses
# (sequential strings handled via sequence checks; common words handled via dictionary checks)
dictcheck = 1
usercheck = 1
gecoscheck = 1
# Reject simple sequences (e.g., 1234, abcd) of this length or more
maxsequence = 3

# Prevent reuse patterns
difok = 4

# Enforce quality checks
enforce_for_root = 1
retry = 3

# Compromised password screening is not provided by pam_pwquality itself.
# Implement via PAM modules (e.g., pam_pwned / custom check) or SSSD/IdP policy.
# Password hints are an application/UI policy and are not configured here.