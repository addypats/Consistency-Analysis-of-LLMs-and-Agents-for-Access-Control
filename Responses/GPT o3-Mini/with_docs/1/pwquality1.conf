# /etc/security/pwquality.conf
#
# NIST-aligned baseline:
# - Minimum length 8; encourage longer (target 15+); allow long passphrases (up to 64)
# - No required composition rules (special characters not mandated)
# - Reject weak patterns (e.g., "password", sequences) and dictionary words
# - Use compromised password screening via a cracklib/pwquality dictionary
#   (populate dictpath with a compromised-password list, e.g., from HIBP or internal source)

# Enforce minimum length
minlen = 8

# Encourage longer passwords by requiring more "credit" (i.e., more chars) for shorter ones
# and by allowing long passphrases
maxlen = 64

# Do NOT require specific character classes (no special-char mandates)
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 0

# Basic quality checks (reject common/obvious weaknesses)
# - difok: require some change from old password
# - maxrepeat/maxsequence: reduce repeated/sequential patterns
# - usercheck/gecoscheck: avoid user info
difok = 4
maxrepeat = 3
maxsequence = 3
usercheck = 1
gecoscheck = 1

# Dictionary/common-word checks
dictcheck = 1
# Provide a dictionary file (compiled cracklib dict) that includes:
# - common passwords (e.g., "password", "123456", etc.)
# - organization-specific banned words
# - previously compromised password list (breached passwords)
dictpath = /var/lib/pwquality/cracklib

# Enforce these checks for all users (including root)
enforcing = 1

# Password hints are not a pwquality setting; disable hints in the application/IdP layer.