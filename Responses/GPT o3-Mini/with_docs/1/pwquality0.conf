# /etc/security/pwquality.conf
# NIST-aligned guidance (SP 800-63B): favor length over composition; screen against weak/breached passwords.

# Enforce minimum length; encourage longer passphrases (up to 64 chars)
minlen = 8
maxlen = 64

# Do not require specific character classes (no mandatory complexity rules)
minclass = 0
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Reject obvious weaknesses: repeats and simple sequences; also avoid passwords containing the username
maxrepeat = 3
maxsequence = 3
usercheck = 1
gecoscheck = 1

# Make failures actionable (do not disclose the specific rule violated)
enforce_for_root
dictcheck = 1
retry = 3

# Note: Screening against lists of previously compromised passwords requires an additional PAM module
# (e.g., pam_pwned, pam_haveibeenpwned, or a local breached-password hash set) and is not provided
# by pwquality.conf itself. Password hints and MFA/risk-based authentication are out of scope here.