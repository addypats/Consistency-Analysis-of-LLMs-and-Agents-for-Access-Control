# /etc/security/pwquality.conf
#
# NIST SP 800-63B-aligned pwquality policy (length + breached/common/sequential checks).
# Note: MFA, risk-based auth, and "no password hints" are not enforced by pwquality.

# Minimum length: at least 8; encourage longer (enforced minlen only)
minlen = 8

# Allow long passphrases (pwquality max is 31 on many distros; PAM can accept longer)
# If supported by your build, set to 64; otherwise omit/leave default.
maxlen = 64

# Do not require specific character classes (avoid predictable composition rules)
minclass = 0
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Reject passwords that are too simple / based on words (common words like "password")
dictcheck = 1

# Reject obvious sequences / monotonic runs
maxsequence = 3

# Require sufficient change from old password (helps against trivial variants)
difok = 5

# Enforce for root as well
enforce_for_root

# Remember: Screening against known-compromised passwords (HIBP/breached lists)
# is NOT provided by pwquality. Implement via PAM (e.g., pam_pwned/pam_haveibeenpwned)
# or equivalent external checker in your authentication stack.