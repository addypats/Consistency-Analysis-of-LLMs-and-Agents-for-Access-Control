# /etc/security/pwquality.conf
#
# NOTE: pwquality.conf only controls password quality checks at password-set
# time. Many requirements listed (MFA, expiration, lockouts/throttling,
# inactivity lock, disable hints, monitoring/alerting, account suspension, etc.)
# must be enforced via PAM (e.g., pam_faillock), login/SSSD/LDAP policy,
# systemd-logind, and/or other components.
#
# NIST SP 800-63B (800-63-4 draft) alignment notes:
# - No maximum length enforced here (maxlen not set).
# - Enforce min length and require at least one non-alphabetic for password-only
#   accounts via minclass=2 (alphabetic + something else).

# Minimum password length (password-only accounts)
minlen = 14

# Do not limit maximum password length (leave unset)
# maxlen =

# Allow all character types (no credit restrictions), but require at least one
# non-alphabetic character for password-only accounts:
# minclass counts character classes present. Setting to 2 ensures at least two
# classes (e.g., letters + digit/symbol/other).
minclass = 2
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Do not require specific character types beyond minclass
minupper = 0
minlower = 0
mindigit = 0
minspecial = 0

# Reject passwords containing the user name
usercheck = 1

# Reject palindromes (common weak pattern)
palindrome = 1

# Normalize/credit behavior
dictcheck = 1

# Ensure this module actually rejects weak passwords
enforcing = 1

# Retry prompt count during password change
retry = 3

# Use the default pwquality dictionary (configure your internal denylist by
# providing a wordlist here if supported by your distro build of libpwquality)
# dictpath = /path/to/internal_denylist.txt
#
# NOTE: "at least 20 common passwords" and "previous 5 passwords" checks are not
# implemented by pwquality.conf alone. Use pam_pwhistory (remember=5) and/or
# directory service password history features.