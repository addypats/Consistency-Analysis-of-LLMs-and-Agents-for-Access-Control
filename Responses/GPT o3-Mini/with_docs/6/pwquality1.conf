# /etc/security/pwquality.conf
# NIST SP 800-63B-aligned password quality settings (Linux PAM pwquality)
#
# NOTE:
# - pwquality controls *password composition/quality* only.
# - MFA requirements, session lock, lockouts/throttling, password history/deny lists,
#   expiration, inactivity disable, alerts, and password hints are enforced via other
#   components (PAM faillock, pam_tally2, pam_faillock, pam_pwhistory, chage/login.defs,
#   systemd-logind, sshd, desktop env, SIEM/auditd, etc.).

# Minimum length:
# - For password-only accounts: minlen=14 (set here).
# - For MFA-enabled accounts: allow 8 via per-service/per-user overrides in PAM stack.
minlen = 14

# Do not limit maximum length (pwquality itself does not impose a max; leave unset).
# maxlen =

# Allow all character types; require at least one non-alphabetic character.
# (dcredit/ocredit >= 1 means at least one digit OR other; using ocredit enforces non-alpha.)
ucredit = 0
lcredit = 0
dcredit = 0
ocredit = 1

# Do not require multiple character classes beyond the above.
minclass = 0

# Reject simplistic passwords based on common patterns.
gecoscheck = 1
usercheck = 1

# Enforce differences from old password when changing.
difok = 4

# Limit repeated characters / monotonic sequences.
maxrepeat = 3
maxsequence = 3

# Enable cracklib-style checks if available.
dictcheck = 1

# Require enforcement for privileged users too.
enforce_for_root

# Retry prompts when changing passwords (PAM will handle; included for completeness).
retry = 3