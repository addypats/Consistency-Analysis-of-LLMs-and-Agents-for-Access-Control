# /etc/security/pwquality.conf
#
# NOTE:
# - pam_pwquality controls password composition/quality only.
# - MFA requirements, inactivity lock, lockout/throttling, expiration, history,
#   deny-lists, disabled hints, monitoring/alerts, and inactive-account suspension
#   are NOT enforceable from this file; they must be implemented via PAM, authselect,
#   faillock, systemd-logind/desktop settings, login.defs, chage, PAM pwhistory,
#   pam_faillock, audit/SIEM, etc.

# Require minimum length of 14 for password-only accounts.
# (For MFA-enabled accounts, enforce minlen=8 via a separate PAM service stack
#  or conditional configuration; pwquality.conf is global.)
minlen = 14

# Do not limit maximum length of passwords here (as long as possible).
# pwquality does not impose a hard max length; leave maxlen unset.
# maxlen = 0

# Allow all character types; require at least one non-alphabetic character
# for password-only accounts by requiring at least 1 digit OR 1 other.
# (This cannot be made conditional on MFA in this file.)
dcredit = -1
ocredit = -1
ucredit = 0
lcredit = 0

# Enable checks (defaults are typically enabled, but set explicitly)
difok = 4
gecoscheck = 1
dictcheck = 1
usercheck = 1

# Enforce checks even for root (recommended for consistent policy)
enforce_for_root

# Do not allow passwords that are purely a palindrome (extra hardening)
palindrome = 1

# Do not allow passwords containing the username (extra hardening)
# (usercheck already helps; this is an additional toggle in some builds)
# containsuser = 1