# /etc/security/pwquality.conf
#
# Note: This file configures libpwquality (password construction quality).
# Many listed NIST 800-63B controls (MFA, expiration, lockout/throttling,
# inactivity lock, suspend inactive accounts, alerts, password hints) are
# implemented via PAM modules (e.g., pam_faillock), login/SSSD, systemd-logind,
# and account policy tools (chage), not via pwquality.conf.

# Enforce minimum length (password-only accounts)
minlen = 14

# Maximum length: do not limit (use system defaults/constraints)
# (libpwquality itself does not impose a max when unset)
# maxlen =

# Allow all character types; require at least one non-alphabetic character
# (i.e., digits or special). Setting minclass=2 enforces at least two character
# classes; with digits/others not required explicitly, this meets the "at least
# one non-alphabetic" requirement while allowing any mix.
minclass = 2

# Do not require specific classes beyond the above
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Deny list / dictionary checking (internal word list of weak/common passwords)
dictcheck = 1

# Fail closed on internal errors
enforcing = 1

# Do not permit simple modifications of existing dictionary words
# (helps against common-password variants)
maxrepeat = 3
maxsequence = 3
gecoscheck = 1

# If using an internal denylist, point pwquality at it (create/populate file).
# (At least 20 common passwords as required; more recommended.)
dictpath = /etc/security/pwquality.denylist

# NOTE: Checking against previous 5 passwords is not handled by pwquality;
# configure pam_pwhistory (remember=5) or equivalent in PAM.