# /etc/security/pwquality.conf
#
# NIST SP 800-63B-aligned password composition policy (pam_pwquality).
# NOTE: Many requested controls (MFA, expiration, lockout/throttling, inactivity
# locking, disable hints, deny-lists/history, alerts, dormant account disable)
# are NOT configurable in pwquality.conf; they must be implemented via PAM
# (pam_faillock/pam_tally2), pam_unix + remember, pam_pwhistory, cracklib
# dict/deny lists, login.defs/chage, systemd-logind, SSHD/GDM, SIEM/auditd, etc.

# ---- Length ----
# Minimum length: 14 for password-only accounts. (For MFA-enabled accounts,
# a shorter minlen (8) requires separate PAM service stacks or conditional rules.)
minlen = 14

# Do not set maxlen: allow maximum length supported by the system (no limit here).
# maxlen = 0

# ---- Character classes ----
# Allow all character types (do not restrict).
# Require at least one non-alphabetic character (digit or special) for password-only accounts:
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 2

# ---- Quality / checks ----
# Perform additional checks and reject simplistic passwords.
difok = 4
maxrepeat = 3
maxsequence = 3

# Enforce for root too (helps ensure admin passwords meet policy).
enforce_for_root

# Do not permit empty passwords.
nullok = 0

# Control whether to reject based on username.
usercheck = 1

# If available in your libpwquality version, enable badword checking.
# (Actual deny-list integration is typically via cracklib dicts or pam_pwhistory.)
badwords = 1

# Retry prompt count when setting a new password.
retry = 3

# ---- Credits (disable "complexity points" shortcuts) ----
# Ensure credits do not reduce required length.
# (Not all versions support these; harmless if ignored.)
credit = 0