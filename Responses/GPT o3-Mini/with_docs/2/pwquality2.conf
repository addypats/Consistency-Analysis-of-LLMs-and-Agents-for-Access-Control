# /etc/security/pwquality.conf
#
# NOTE:
# - This file only enforces password *composition/quality* at change time.
# - It cannot enforce rotation/aging (90 days) or minimum-change interval (2 days);
#   those must be configured via account aging (e.g., /etc/login.defs, chage).
# - It also cannot enforce handling rules (no email/sharing/writing down); those are
#   administrative policy controls, not pwquality settings.
#
# NIST SP 800-63B (and draft 800-63-4) generally discourages composition rules and
# periodic expiration unless there is evidence of compromise. This file implements
# the requested composition requirements anyway.

# Minimum length
minlen = 8

# Require at least 1 alphabetic character (credit for max of 1)
ucredit = 1

# Require at least 1 digit (credit for max of 1)
dcredit = 1

# No specific requirement for other classes
lcredit = 0
ocredit = 0

# Reject passwords containing the user name (in any case)
usercheck = 1

# Check against cracklib dictionary (reject dictionary-based passwords)
dictcheck = 1

# Enforce for root as well (where supported)
enforce_for_root

# Fail after this many retries
retry = 3

# Do not allow passwords that are too similar to the old one
difok = 4

# Do not allow reuse of the same password
# (Note: actual password history/reuse prevention is typically handled by PAM pwhistory, not pwquality.)
# reuse = 0