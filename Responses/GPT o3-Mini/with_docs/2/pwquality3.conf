# /etc/security/pwquality.conf
#
# NOTE: pwquality.conf only enforces composition/quality checks at password
# change time. It cannot enforce password aging (90 days), minimum change
# interval (2 days), password sharing/communication rules, or storage rules.
# Enforce those via /etc/login.defs + chage/passwd aging and organizational policy.

# Minimum length
minlen = 8

# Require at least 1 digit
dcredit = -1

# Require at least 1 letter (either upper or lower)
ucredit = 0
lcredit = 0

# Require at least 1 non-alphanumeric? (not requested)
ocredit = 0

# Minimum number of character classes required:
# (digit + letter => at least 2 classes)
minclass = 2

# Reject passwords based on dictionary words (requires libpwquality dict support)
dictcheck = 1

# Reject passwords containing the user name (in normal or reversed form)
usercheck = 1

# Reject passwords containing the GECOS/real name (where supported)
gecoscheck = 1

# Require some differences from the old password (helps prevent trivial changes)
difok = 4

# Retry prompt count
retry = 3

# Apply to root as well
enforce_for_root = 1