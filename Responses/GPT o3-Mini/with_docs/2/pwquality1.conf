# /etc/security/pwquality.conf
#
# NOTE:
# - This file controls password *quality* checks at password change time.
# - It cannot enforce: 90-day expiration, 2-day minimum age, "do not email/share",
#   or "do not write down/store unencrypted". Those are handled by account aging
#   (/etc/login.defs, chage) and organizational policy/training.
# - NIST SP 800-63B guidance: https://pages.nist.gov/800-63-4/sp800-63b.html

# Minimum length
minlen = 8

# Require at least 1 letter and 1 digit
lcredit = 1
dcredit = 1

# Require at least 2 character classes total (digits, upper, lower, other)
minclass = 2

# Reject passwords based on dictionary words
dictcheck = 1

# Reject passwords that contain the username (approximate "not part of your name")
usercheck = 1

# Do not allow simple rotations/new passwords too similar to old
difok = 4

# Allow up to 3 attempts
retry = 3

# Enforce checks even for root
enforce_for_root = 1