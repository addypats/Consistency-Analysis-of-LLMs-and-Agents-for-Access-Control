# /etc/security/pwquality.conf
#
# NIST-aligned guidance:
# - Minimum length: 8 (recommend 15+)
# - Prefer long passphrases (allow up to 64 chars)
# - No mandatory composition rules (no required special chars/classes)
# - Reject obvious weak patterns/words (handled by libpwquality checks)
# - Screen against known-compromised passwords (requires separate denylist)
# - MFA / risk-based auth are not configured here (handled by PAM/auth stack)

# Minimum acceptable length
minlen = 8

# Credit/passphrase-friendly: don't require character classes
minclass = 0
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Encourage longer passwords by not penalizing repeats/sequence too aggressively,
# but still apply basic quality checks.
maxrepeat = 0
maxsequence = 0
gecoscheck = 1
dictcheck = 1
usercheck = 1
enforcing = 1
retry = 3

# Allow long passphrases (NIST suggests up to 64 characters)
# NOTE: libpwquality itself does not enforce a maximum length; set in PAM if needed.
# This is informational here; ensure PAM "pam_pwquality.so" uses any relevant options
# (and that underlying auth stores support it).

# Compromised password screening:
# Point to a local denylist generated from breached-password sources.
# NOTE: This requires pam_pwquality/libpwquality support for this option on your distro.
badwords_file = /etc/security/breached-passwords.deny

# Password hints are not configured here; ensure your applications do not provide hints.