# /etc/security/pwquality.conf
#
# Password quality configuration (pam_pwquality).
# Note: MFA/risk-based auth and "no password hints" are enforced outside pwquality.

# Minimum length requirements
minlen = 8
# Encourage longer passwords (not enforced); NIST allows up to 64 chars.
maxlen = 64

# Disable composition/complexity requirements (avoid predictable complexity rules)
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 0

# Reject obvious weaknesses
# difok: require some difference from old password (helps avoid trivial changes)
difok = 4
# maxrepeat/maxsequence: reduce obvious patterns like "aaaa" or "1234"
maxrepeat = 3
maxsequence = 3

# Dictionary/common-word checks (uses cracklib wordlist if installed)
dictcheck = 1

# Screen against compromised passwords (requires libpwquality cracklib integration and a populated dictionary list;
# for best results use a dedicated breached-passwords checker such as pam_pwned)
# (No native direct "breached list" knob in pwquality.conf beyond dictcheck.)