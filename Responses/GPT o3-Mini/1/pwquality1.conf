# /etc/security/pwquality.conf
#
# Password policy aligned with NIST-style guidance:
# - Minimum length 8; encourage longer (15+)
# - No mandatory composition rules
# - Reject obvious weak passwords (sequences, repeats, dictionary-like)
# - Allow long passphrases (up to 64)
#
# Note: MFA/risk-based authentication and password hints are not controlled by
# pwquality; enforce via application/IdP policy.

# Minimum length requirement
minlen = 8

# Encourage longer passwords (15+) via stricter checks for shorter passwords
# (more credits allowed -> less strict, so keep credits at 0 and require
# additional checks via other parameters below)
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Disallow simplistic patterns / reduce predictability
maxrepeat = 2
maxsequence = 3
difok = 4

# Dictionary / common-word checks (rejects simple/common passwords)
dictcheck = 1

# Check user/GECOS info where supported (helps reject passwords like username)
usercheck = 1
gecoscheck = 1

# Allow long passphrases (NIST allows up to 64)
pass_max_len = 64

# Enforce for all users including root
enforce_for_root = 1

# You should additionally configure PAM with pwhistory to prevent reuse, e.g.:
# password required pam_pwhistory.so remember=24 use_authtok
#
# For breached-password screening (HIBP/enterprise list), add a PAM module such as:
# - pam_pwned (or an equivalent offline breached-password list integration)
# pwquality alone cannot perform breach-list checks.