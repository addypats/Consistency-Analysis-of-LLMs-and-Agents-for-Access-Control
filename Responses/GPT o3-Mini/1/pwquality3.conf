# /etc/security/pwquality.conf
#
# Enforces a length-focused password policy aligned with modern guidance.
# Note: MFA/risk-based authentication and "no password hints" are not
# configurable in this file; implement those in your authentication stack/UI.

# Minimum length (required)
minlen = 8

# Encourage longer passwords (recommended target)
# (pwquality has no "recommended length" knob; use minlen plus maxlen below.)

# Allow long passphrases (NIST allows up to 64+; set to 64 here)
maxlen = 64

# Do not require special character composition rules
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0
minclass = 0

# Check for obvious weaknesses (dictionary/common words/sequences/keyboard patterns)
dictcheck = 1
usercheck = 1
gecoscheck = 1
maxrepeat = 3
maxsequence = 3
maxclassrepeat = 4

# Require multiple checks to pass
retry = 3

# Previously compromised/breached password screening:
# Not supported by pam_pwquality directly. Configure pam_pwned/pam_haveibeenpwned
# or similar in PAM to enforce this requirement.