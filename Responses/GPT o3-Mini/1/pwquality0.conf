# /etc/security/pwquality.conf
#
# Password quality policy aligned with NIST-style guidance:
# - Minimum length 8; recommend 15+; allow passphrases up to 64.
# - No composition requirements (no forced digits/specials/etc.).
# - Reject obvious weak patterns (sequences, repeats, dictionary words).
# - Use a compromised-password check via a PAM module/service (not handled here).
# - MFA / risk-based auth are outside pwquality scope (configure in PAM/SSSD/IdP).

# Enforce minimum length; encourage longer passphrases by allowing up to 64.
minlen = 8
maxlen = 64

# Do not require character class composition.
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Reject passwords that are too simple/obvious.
# - difok: require sufficient difference from old password
# - minclass: no minimum character classes
# - maxrepeat: limit repeated characters
# - maxsequence: block monotonic sequences (e.g., 1234, abcd)
# - dictcheck: check against cracklib dictionary
# - usercheck/gecoscheck: disallow inclusion of username or GECOS fields
difok = 4
minclass = 0
maxrepeat = 3
maxsequence = 3
dictcheck = 1
usercheck = 1
gecoscheck = 1

# Enforce policy (fail rather than just warn).
enforcing = 1

# Note: Screening against breached-password lists is not provided by pwquality.
# Implement with a PAM module such as pam_pwned/pam_haveibeenpwned or similar.
#
# Note: Password hints are not controlled here; disable in application/UI policy.
#
# Note: MFA/risk-based auth are configured in authentication stack/IdP, not here.