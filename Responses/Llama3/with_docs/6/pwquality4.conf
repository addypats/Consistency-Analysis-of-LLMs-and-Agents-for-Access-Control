```
# Policy for password quality
# For security reasons, it's recommended to change passwords regularly.
# The policy below reflects the recommendations for password quality.

# Enable password checking
pwquality:enable = yes

# Check against internal deny list of weak or common passwords
pwquality:check_weakpass = yes
pwquality:weakpass_list = /etc/security/weakpass.list

# Check against previous n passwords (n=5)
pwquality:n = 5

# Set minimum password length based on account type
pwquality:minlen = {
    'account_type=other',         # All accounts except for MFA accounts and those with a specified minlen
        8,
    'account_type=mfa',          # MFA enabled accounts
        14,
}

# Don't set maximum password length to allow as long as possible
pwquality:maxlen = none

# Allow all character types in a password
pwquality:charblacklist = none
pwquality:checkchar = yes

# Enforce at least one non-alphabetic character for account type=other accounts
pwquality:checknonalphanum = yes

# Change the password immediately on breach, with annual expiration as backstop
pwquality:changepassword_policy = {
    'policy=mfa_breach',
    'policy=annual_expiration'
}

# Check against an internal deny list of known bad or weak passwords
pwquality:check_deny_list = yes

# Password change delay (min)
pwquality:delay_before_change = 86400 # 1 day

# Lock current session after inactivity for more than 15 minutes
session_lock_timeout = 900 # 15 min, to be safe we use 15 min

# Temporary account lockout after five consecutive failed attempts
pwquality:max_retry_attempts = 5
pwquality:retry_timeout = {
    '0': 300,
    '1': 600,
    '2': 1200,
    '4': 2400,
    '8': 4800,
}
pwquality:lockout_duration = 900 # 15 min

# Time doubling throttling
pwquality:lockout_interval = {
    '0': 300,
    '1': 600,
    '2': 1200,
    '4': 2400,
    '8': 4800,
}

# Lock account after 12 failed attempts (or more)
pwquality:permanent_lockout_at = 12

# Monitor and alert key personnel when bad login attempts reach the login limit
pwquality:login_limit_alert = yes

# Automatically suspend account after 45 days without valid login
pwquality:suspend_account_after_days = 45

# Don't allow user-defined password hints at login
pwquality:ignore_password_hints = yes
```