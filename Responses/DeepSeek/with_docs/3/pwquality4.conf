# /etc/security/pwquality.conf
# Password quality configuration for pam_pwquality

# Minimum password length
minlen = 8

# Require at least 1 character that isn't in the old password
difok = 1

# Check against words in cracklib dictionary
dictcheck = 1

# Check if password contains the username in any form
usercheck = 1

# Number of retries allowed before returning an error
retry = 3

# Additional security settings (NIST SP 800-63B recommendations)
# Maximum number of consecutive identical characters
maxrepeat = 2

# Maximum number of consecutive characters of same class
maxclassrepeat = 2

# Minimum number of different character classes required
minclass = 3

# Character classes: digits, uppercase, lowercase, others
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Prevent common patterns and sequences
enforce_for_root = 1
local_users_only = 0
enforcing = 1