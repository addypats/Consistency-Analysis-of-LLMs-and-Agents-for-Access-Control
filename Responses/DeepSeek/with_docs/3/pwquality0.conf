# /etc/security/pwquality.conf
# Password quality configuration for pam_pwquality

# Minimum password length
minlen = 8

# Require at least one character that wasn't in the old password
difok = 1

# Disallow words from cracklib dictionary
dictcheck = 1

# Disallow username in any form (forward, backward, or mixed case)
usercheck = 1

# Disallow palindrome passwords
palindrome = 1

# Maximum number of retries before returning error
retry = 3

# Additional security settings (recommended by NIST SP 800-63B)
# Disallow consecutive identical characters
maxrepeat = 2

# Disallow sequential characters (e.g., "abcd", "1234")
maxsequence = 3

# Disallow common keyboard patterns (e.g., "qwerty", "asdfgh")
maxclassrepeat = 2

# Require at least one of each character class:
# - Lowercase letters
# - Uppercase letters  
# - Digits
# - Special characters
minclass = 4

# Note: This configuration will be enforced by the PAM module pam_pwquality
# Ensure the PAM configuration includes: password requisite pam_pwquality.so retry=3