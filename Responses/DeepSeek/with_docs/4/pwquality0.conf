# /etc/security/pwquality.conf
# Password policy compliant with NIST SP 800-63B requirements

# Minimum password length (NIST requirement: at least 8 characters for user-chosen passwords)
minlen = 8

# Maximum password length (NIST recommends allowing at least 64 characters)
maxlen = 64

# Do not enforce character class requirements (NIST discourages composition rules)
# NIST specifically advises against requiring mixtures of character types
minclass = 0

# Do not enforce maximum consecutive identical characters
# NIST discourages prohibiting consecutively repeated characters
maxrepeat = 0

# Do not enforce maximum consecutive same class characters
maxclassrepeat = 0

# Do not enforce character sequence restrictions
# NIST discourages arbitrary composition rules
maxsequence = 0

# Do not enforce maximum consecutive characters of same case
maxupperrepeat = 0
maxlowerrepeat = 0

# Do not enforce checks for palindromes
palindrome = 0

# Do not enforce checks for dictionary words (handled by blacklist instead)
dictcheck = 0

# Do not enforce checks for user/gecos information
usercheck = 0

# Do not enforce checks for consecutive characters
gecoscheck = 0

# Do not enforce checks for reversed dictionary words
reversedcheck = 0

# Do not enforce checks for consecutive characters of same class
enforce_for_root = 1

# Enable blacklist checking (NIST requires checking against compromised passwords)
# Note: The actual blacklist file should be maintained separately
# and updated regularly with compromised passwords
blacklist = /etc/security/pwquality.blacklist

# Do not enforce arbitrary password expiration (NIST discourages periodic changes)
# Password changes should only be forced upon evidence of compromise

# Note: Additional implementation details:
# 1. Rate limiting for authentication attempts must be implemented at application level
# 2. Password strength meter should be provided at application level
# 3. Unicode normalization (NFKC/NFKD) should be handled at application level
# 4. Password hints should not be stored or prompted for
# 5. Context-specific words (service name, username) should be checked at application level