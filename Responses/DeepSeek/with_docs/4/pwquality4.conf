# /etc/security/pwquality.conf
# Password policy configuration based on NIST SP 800-63B requirements

# Minimum password length (NIST requires at least 8 characters for user-chosen passwords)
minlen = 8

# Maximum password length (NIST recommends allowing at least 64 characters)
maxlen = 64

# Do not enforce character class requirements (NIST discourages composition rules)
# minclass = 0

# Do not require specific character types (NIST discourages composition rules)
# dcredit = 0
# ucredit = 0
# lcredit = 0
# ocredit = 0

# Do not enforce consecutive identical characters restriction
# maxrepeat = 0

# Do not enforce sequential characters restriction
# maxsequence = 0

# Dictionary check - check against common passwords and dictionary words
dictcheck = 1

# User check - check if password contains username
usercheck = 1

# Check if password is a palindrome
# (NIST discourages composition rules, but this helps prevent trivial passwords)
palindrome = 1

# Check for similar passwords (based on Levenshtein distance)
# (Helps prevent trivial modifications of weak passwords)
difok = 5

# Enforce password complexity by rejecting passwords that are too simple
# (NIST discourages composition rules, but allows for blacklist checking)
enforce_for_root = 1
retry = 3

# Note: This configuration follows NIST SP 800-63B guidelines by:
# 1. Requiring minimum 8 character length for user-chosen passwords
# 2. Allowing up to 64 characters
# 3. Not imposing character composition rules
# 4. Checking against common/compromised passwords via dictcheck
# 5. Checking for context-specific words via usercheck
# 6. Preventing trivial passwords via palindrome check
# 7. Preventing trivial modifications via difok setting