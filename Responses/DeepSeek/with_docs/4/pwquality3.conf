# /etc/security/pwquality.conf
# Password policy based on NIST SP 800-63B guidelines

# Minimum password length (NIST: 8 characters for user-chosen passwords)
minlen = 8

# Maximum password length (NIST: at least 64 characters should be permitted)
# Note: Setting to 0 means unlimited, but system may have other limits
maxlen = 0

# Dictionary check - check against dictionary words
dictcheck = 1

# User check - check if password contains the username
usercheck = 1

# Check if password is a palindrome
palindrome = 1

# Check for consecutive characters (e.g., aaaaaa, 1234abcd)
maxrepeat = 2

# Check for consecutive same class characters (e.g., all lowercase)
maxclassrepeat = 2

# Minimum number of character classes required
# NIST recommends NOT imposing composition rules, but we set minimal requirements
# 0 = no requirement, 1 = at least one class, etc.
minclass = 0

# Maximum allowed consecutive identical characters
# NIST discourages this rule, but we set a reasonable limit
maxsequence = 3

# Check for monotonic sequences (e.g., 123456, abcdef)
gecoscheck = 1

# Check against common passwords from previous breaches
# This should be implemented with a proper blacklist
# (Note: pwquality may not have built-in breach corpus checking)
badwords = password,123456,qwerty,admin,letmein,welcome

# Allow all printable ASCII characters and space
# Note: pwquality doesn't have explicit settings for Unicode, 
# but system should accept Unicode characters as per NIST
# The following settings ensure maximum flexibility:

# Allow digits (0-9)
dcredit = 0

# Allow uppercase letters (A-Z)
ucredit = 0

# Allow lowercase letters (a-z)
lcredit = 0

# Allow special characters (!@#$%^&*(), etc.)
ocredit = 0

# Allow spaces (NIST recommends allowing space character)
# Note: Some systems may handle spaces differently
spcredit = 0

# Enforce these checks for root as well
enforce_for_root = 1

# Retry prompt (number of retries before giving up)
retry = 3

# Local users only (not for remote authentication)
local_users_only = 0

# Note: Additional NIST requirements that need system-level implementation:
# 1. Rate-limiting for failed authentication attempts
# 2. Password blacklist/breach corpus checking
# 3. Unicode normalization (NFKC or NFKD)
# 4. No password hints storage
# 5. No periodic password changes
# 6. Password strength meter guidance
# These should be implemented in the authentication system, not just pwquality.conf