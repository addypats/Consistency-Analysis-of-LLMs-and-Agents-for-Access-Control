# /etc/security/pwquality.conf
# Password quality configuration for PCI DSS compliance

# Password length requirements (8.3.6, 8.2.3)
minlen = 12
# Note: 8.2.3 mentions 7 characters minimum, but 8.3.6 requires 12
# We implement the stricter requirement (12 characters)

# Character class requirements (8.3.6, 8.2.3)
minclass = 2  # Require at least 2 character classes (alphabetic and numeric)
dcredit = -1  # Require at least 1 digit
lcredit = -1  # Require at least 1 lowercase letter
ucredit = 0   # Allow but don't require uppercase letters
ocredit = 0   # Allow but don't require other characters

# Password history (8.2.5, 8.3.7)
remember = 4  # Remember last 4 passwords (do not allow reuse)

# Password complexity
difok = 5     # Require at least 5 characters different from old password
maxrepeat = 2 # Maximum 2 consecutive identical characters
maxsequence = 3 # Maximum length of monotonic character sequences

# Dictionary checks
dictcheck = 1 # Check against dictionary words
dictpath = /usr/share/dict/words

# Additional security settings
usercheck = 1 # Check if password contains username
enforcing = 1 # Enforce checking for all users
retry = 3     # Number of retries for entering a valid password

# Note: The following requirements are handled by other mechanisms:
# - Account lockout after 6 attempts (8.1.6) → Configured in PAM
# - Lockout duration 30 minutes (8.1.7) → Configured in PAM  
# - Session timeout 15 minutes (8.1.8) → Configured in /etc/profile or PAM
# - Password expiration 90 days (8.2.4) → Configured in /etc/login.defs
# - First-time password reset (8.2.6) → Configured in PAM
# - MFA requirements (8.4.1 to 8.5.1) → Configured in PAM and MFA system
# - No hardcoded passwords (8.6.2, 8.6.3) → Policy enforcement