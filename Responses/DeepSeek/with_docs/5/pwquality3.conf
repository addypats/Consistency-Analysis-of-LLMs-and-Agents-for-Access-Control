# /etc/security/pwquality.conf
# Password quality configuration file
# Generated based on security policy requirements

# Password length requirements
minlen = 12
# Note: Additional requirement for minimum 7 characters is superseded by minlen=12

# Character class requirements
minclass = 2  # Require at least 2 character classes
dcredit = -1   # Require at least 1 digit
ucredit = -1   # Require at least 1 uppercase letter
lcredit = -1   # Require at least 1 lowercase letter
# Note: This ensures both numeric and alphabetic characters as required

# Password history
remember = 4   # Remember last 4 passwords (do not allow reuse)
# Note: This satisfies both 8.2.5 and 8.3.7 requirements

# Password complexity
difok = 5      # Require at least 5 characters different from old password
maxrepeat = 2   # Allow maximum 2 consecutive identical characters
maxsequence = 3 # Reject passwords containing monotonic character sequences

# Dictionary checks
dictcheck = 1   # Check against dictionary words
dictpath = /usr/share/dict/words

# Username checks
usercheck = 1   # Check if password contains username
badwords = admin root password 123456 qwerty

# Additional security settings
enforce_for_root = 1  # Apply policy to root user as well
retry = 3             # Number of retries before returning failure

# Note: The following requirements are handled by other system components:
# - Account lockout after 6 attempts (8.1.6) - Configured in /etc/security/faillock.conf or PAM
# - Lockout duration 30+ minutes (8.1.7, 8.3.4) - Configured in /etc/security/faillock.conf
# - Session timeout 15 minutes (8.1.8) - Configured in /etc/profile, /etc/bash.bashrc, or PAM
# - Password expiration 90 days (8.2.4) - Configured in /etc/login.defs
# - First-time password change (8.2.6) - Configured in /etc/shadow (chage command)
# - MFA requirements (8.4.1-8.5.1) - Configured in PAM and/or SSHD
# - No hardcoded passwords (8.6.2, 8.6.3) - Policy/process requirement