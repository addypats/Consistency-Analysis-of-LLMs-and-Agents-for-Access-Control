# /etc/security/pwquality.conf
# Password quality configuration for PCI DSS compliance

# Minimum password length (8.2.3, 8.3.6)
# Note: 8.3.6 requires 12 characters, 8.2.3 requires 7 characters
# Setting to 12 to meet the stricter requirement
minlen = 12

# Maximum password length (no specific requirement, but reasonable limit)
maxlen = 64

# Password complexity requirements
# Require at least one digit (numeric character)
dcredit = -1
# Require at least one lowercase character
lcredit = -1
# Require at least one uppercase character
ucredit = -1
# Require at least one other (special) character
ocredit = -1

# Password similarity check
# Check if the password contains the username
usercheck = 1
# Number of characters that must be different from the old password
difok = 8

# Dictionary check
# Check passwords against dictionary words
dictcheck = 1
# Path to dictionary (if available)
# dictpath = /usr/share/dict/words

# Password history (8.2.5, 8.3.7)
# Remember last 4 passwords (minimum requirement)
remember = 4

# Password aging (8.2.4)
# Note: Password aging is configured in /etc/login.defs, not here
# PASS_MAX_DAYS = 90 should be set in /etc/login.defs

# Retry limit (8.1.6, 8.3.4)
# Note: Account lockout is configured in PAM, not here
# pam_faillock should be configured for max 6-10 failed attempts

# Session timeout (8.1.8)
# Note: Session timeout is configured in /etc/profile or PAM
# TMOUT=900 should be set for 15 minute timeout

# Additional security notes:
# 1. Default accounts must be removed/disabled (2.1)
# 2. Inactive accounts must be removed within 90 days (8.1.4)
# 3. MFA must be implemented for CDE access (8.4.1 to 8.5.1)
# 4. Passwords must not be hardcoded in scripts (8.6.2)
# 5. Passwords must be changed if compromised (8.3.8)
# 6. First-time passwords must be unique and changed immediately (8.2.6)