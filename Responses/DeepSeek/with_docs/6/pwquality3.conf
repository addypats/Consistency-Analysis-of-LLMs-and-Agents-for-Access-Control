# /etc/security/pwquality.conf
# Password quality configuration for NIST 800-63B compliance

# Password length settings (5.1.1)
# Minimum length for password-only accounts: 14 characters
# Minimum length for MFA-enabled accounts: 8 characters
# Note: MFA enforcement is configured elsewhere
minlen = 14
# Maximum length should be as long as possible (no limit)
maxrepeat = 0
maxclassrepeat = 0

# Character class requirements (5.1.2)
# Allow all character types
# Require at least one non-alphabetic character for password-only accounts
minclass = 2
dcredit = 0
ucredit = 0
lcredit = 0
ocredit = 0

# Password history and deny list (5.1.4)
# Check against previous 5 passwords
remember = 5
# Note: Internal deny list of known bad/weak passwords should be implemented
# separately (e.g., using cracklib dictionary)

# Password change delay (5.1.4)
# Note: Minimum 1-day delay between password changes must be enforced
# through PAM configuration, not pwquality

# Account lockout and throttling (5.1.6)
# Note: These settings are configured in PAM, not pwquality:
# - 15+ minute lockout after 5 consecutive failed attempts
# - Time doubling throttling (0, 1, 2, 4, 8 minutes)
# - Permanent lockout after 12 retries (IT reset required)

# Additional notes for system administrators:
# 1. MFA should be enabled wherever possible (2.1)
# 2. Passwords should be changed immediately after breach detection (5.1.3)
# 3. Annual password expiration should be configured as backstop (5.1.3)
# 4. Session lock after 15 minutes inactivity (5.1.5) - configure in PAM/display manager
# 5. Monitor and alert on bad login attempts reaching limits (5.1.7)
# 6. Automatic account suspension after 45 days without login (5.1.8)
# 7. Disable password hints (5.1.9) - configure in application settings

# This file must be used in conjunction with appropriate PAM configurations
# to fully implement NIST 800-63B requirements