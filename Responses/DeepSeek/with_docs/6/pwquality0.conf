# /etc/security/pwquality.conf
# NIST SP 800-63B compliant password policy

# Password length settings
# Minimum length for password-only accounts: 14 characters
# Minimum length for MFA-enabled accounts: 8 characters
# Note: MFA requirement must be enforced at application/authentication level
minlen = 14
# Maximum length should be as long as possible (no artificial limit)
maxrepeat = 0
maxclassrepeat = 0

# Character class requirements
# Require at least one non-alphabetic character for password-only accounts
# (MFA accounts can have this requirement relaxed to minlen=8)
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = -1

# Password complexity settings
minclass = 3
# Allow all character types
difok = 1

# Password history and deny list settings
# Check against previous 5 passwords
remember = 5
# Note: Internal deny list of known bad/weak passwords must be implemented
# at application level (at least 20 common passwords)

# Password change restrictions
# Enforce minimum password age of 1 day
minage = 1
# Maximum password age (annual expiration as backstop) - 365 days
# Note: This should be enforced via PAM or system policy
maxage = 365

# Account lockout settings
# Temporary lockout (15 minutes) after 5 consecutive failed attempts
# Note: These settings are typically configured in PAM or fail2ban
# The following are recommendations for implementation:

# For PAM configuration (pam_tally2 or pam_faillock):
# deny = 5
# unlock_time = 900
# fail_interval = 900

# Time doubling throttling (0, 1, 2, 4, 8 minutes between retries)
# Permanent lockout after 12 retries (IT reset required)
# Note: These advanced throttling features require custom implementation
# or specialized authentication systems

# Session timeout
# Lock current session after 15 minutes of inactivity
# Note: This should be configured in PAM, display manager, or shell settings

# Account suspension
# Automatically suspend account after 45 days without valid login
# Note: This requires cron job or identity management system implementation

# Security monitoring
# Alert key personnel when login limits are reached
# Note: Requires integration with monitoring/alerting system

# Password hints
# Do not allow user-defined password hints
# Note: This must be enforced at application level

# Additional security recommendations:
# 1. Implement MFA wherever possible
# 2. Change passwords immediately after breach detection
# 3. Regular security audits and monitoring
# 4. User security awareness training

# Note: Many NIST requirements (MFA, account lockout policies, session management,
# account suspension, monitoring/alerts) require additional system configuration
# beyond pwquality.conf. This file provides the password quality foundation.