# /etc/security/pwquality.conf
# Password quality configuration file
# Generated according to NIST SP 800-63B guidelines

# Password length settings
# Minimum length for password-only accounts: 14 characters
# Minimum length for MFA-enabled accounts: 8 characters (configured elsewhere)
minlen = 14
# Do not limit maximum password length
maxlen = -1

# Character class requirements
# Require at least one non-alphabetic character for password-only accounts
minclass = 2
# Allow all character types
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Password history and deny list
# Check against previous 5 passwords
remember = 5
# Check against internal deny list of known bad/weak passwords
dictcheck = 1
# Minimum 20 common passwords in deny list (configured in separate dictionary)
dictpath = /usr/share/dict/cracklib-small

# Password change restrictions
# Enforce minimum password age (1 day = 86400 seconds)
minage = 1
# Maximum password age (365 days = 31536000 seconds)
maxage = 31536000

# Password retry and lockout settings
# Temporary lockout after 5 consecutive failed attempts
retry = 5
# Lockout duration (15 minutes = 900 seconds)
unlock_time = 900
# Time doubling throttling (implemented via PAM, not pwquality)

# Account suspension
# Automatically suspend after 45 days without valid login
# (Configured via PAM or system account policies)

# Note: The following settings are configured elsewhere:
# - MFA requirements (PAM configuration)
# - Session inactivity timeout (15 minutes) (PAM/display manager)
# - Time doubling throttling between retries (PAM)
# - Permanent lockout after 12 retries (PAM/account policies)
# - Monitoring and alerting for bad login attempts (system monitoring)
# - Disabling password hints (application/system configuration)