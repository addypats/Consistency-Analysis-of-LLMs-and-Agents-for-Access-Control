# /etc/security/pwquality.conf
# Password policy configuration based on NIST SP 800-63B guidelines

# Minimum password length for password-only accounts
# Note: MFA-enabled accounts should have minlen=8 (configured elsewhere)
minlen = 14

# Maximum password length (set to maximum system allows)
maxlen = -1

# Password complexity requirements
# Require at least one non-alphabetic character for password-only accounts
minclass = 2
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Password history (remember last 5 passwords)
remember = 5

# Password change delay (minimum 1 day)
# Note: This is typically configured in /etc/login.defs or PAM
# min_days = 1

# Dictionary check (common passwords)
dictcheck = 1
dictpath = /usr/share/dict/words

# User check (no personal information in password)
usercheck = 1

# Enforce all checks
enforcing = 1

# Retry count for password quality check
retry = 3

# Note: The following items are typically configured elsewhere:
# - MFA configuration (PAM modules)
# - Session inactivity timeout (PAM, display managers)
# - Account lockout policies (PAM, faillock)
# - Password expiration (login.defs, chage)
# - Account suspension after inactivity (systemd-logind, cron jobs)
# - Login monitoring and alerts (auditd, log monitoring tools)
# - Password hints (application-specific configuration)

# For complete NIST SP 800-63B compliance, additional configuration is needed in:
# - /etc/pam.d/system-auth and /etc/pam.d/password-auth
# - /etc/login.defs
# - /etc/security/faillock.conf
# - /etc/audit/audit.rules
# - System-wide MFA configuration