# /etc/security/pwquality.conf
# Password policy configuration

# Password length settings (see 5.1.1)
# Note: Minimum length enforcement depends on MFA status
# For password-only accounts: minlen=14 (enforced via PAM configuration)
# For MFA-enabled accounts: minlen=8 (enforced via PAM configuration)
minlen = 8
# Maximum length should not be limited (see 5.1.1)
maxlen = -1

# Character class requirements (see 5.1.2)
# For password-only accounts: require at least one non-alphabetic character
# This is enforced via PAM configuration based on MFA status
minclass = 2
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Password history and deny list (see 5.1.4)
# Check against previous passwords and common weak passwords
remember = 5
dictcheck = 1
usercheck = 1
enforcing = 1
dictpath = /usr/share/dict/cracklib-small
badwords = /etc/security/pwquality-badwords.txt

# Password quality settings
difok = 5
maxrepeat = 2
maxsequence = 3
maxclassrepeat = 2

# Retry and lockout settings (see 5.1.6)
# Note: These are enforced via PAM configuration
# Temporary lockout after 5 failed attempts
# Time doubling throttling: 0, 1, 2, 4, 8, etc. minutes
# Permanent lockout after 12 retries

# Account inactivity (see 5.1.8)
# Note: 45-day automatic suspension enforced via system configuration

# Session timeout (see 5.1.5)
# Note: 15-minute inactivity lock enforced via PAM/session configuration

# Password change requirements (see 5.1.3, 5.1.4)
# Note: Immediate change on breach and 1-day minimum change delay
# enforced via PAM configuration

# Password expiration (see 5.1.3)
# Note: Annual expiration enforced via shadow password system