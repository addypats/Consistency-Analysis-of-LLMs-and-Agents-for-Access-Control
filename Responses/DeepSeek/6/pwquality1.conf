# /etc/security/pwquality.conf
# Password quality configuration file
# Generated according to specified policy rules

# Password length settings
# Minimum length for password-only accounts: 14 characters
# Minimum length for MFA-enabled accounts: 8 characters
# Note: MFA-specific minimum length must be enforced at application level
minlen = 14
# Maximum password length should be as long as possible
# Setting to 0 removes maximum length restriction
maxlen = 0

# Character class requirements
# Allow all character types
# Require at least one non-alphabetic character for password-only accounts
# This is enforced through the dcredit, ucredit, lcredit, and ocredit settings
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = -1
# Require at least one digit AND one other character
minclass = 2

# Password history and deny list settings
# Check against previous passwords (last 5 passwords)
remember = 5
# Use system dictionary check
dictcheck = 1
# Use user information check (username, etc.)
usercheck = 1
# Enforce password change delay (1 day minimum)
# Note: This must be enforced at PAM/system level, not in pwquality
# pwquality only handles quality checking at password change time

# Retry settings for consecutive failed attempts
# Note: These are enforced at PAM/system level (faillock, tally2)
# pwquality does not handle account lockout policies

# Additional quality settings
# Enforce maximum consecutive identical characters
maxrepeat = 3
# Enforce maximum consecutive characters of same class
maxclassrepeat = 4
# Check for palindromes
palindrome = 1
# Check for monotonic sequences (keyboard, alphabetical, numerical)
monotonic = 1
# Check for geometric sequences (keyboard patterns)
geometric = 1
# Check for simple rotations
rotate = 1

# Note: The following policies must be enforced at PAM/system level:
# - MFA implementation and minimum length exceptions
# - Password expiration (annual backstop)
# - Password change delay (1 day minimum)
# - Session inactivity lock (15 minutes)
# - Account lockout after 5 failed attempts (15+ minutes)
# - Time doubling throttling between retries
# - Permanent lockout after 12 retries
# - Monitoring and alerting for bad login attempts
# - Account suspension after 45 days inactivity
# - Disabling password hints