# /etc/security/pwquality.conf
# Password policy configuration based on specified requirements

# Minimum password length for password-only accounts (14 characters)
# For MFA-enabled accounts, this should be overridden to 8 characters
# in the application configuration
minlen = 14

# Maximum password length - set to maximum allowed by system
# Do not limit maximum length
maxrepeat = 0
maxsequence = 0

# Character class requirements
# Require at least one non-alphabetic character for password-only accounts
minclass = 2
dcredit = -1
ucredit = 0
lcredit = 0
ocredit = 0

# Password history and deny list settings
# Check against previous 5 passwords
remember = 5

# Password change delay (minimum 1 day)
# Note: This is typically enforced by PAM, not pwquality
# min_days = 1 should be set in /etc/shadow or /etc/login.defs

# Password quality checking
# Enable dictionary check
dictcheck = 1
# Enable user check (no similarity to username)
usercheck = 1
# Enable enforcing for root
enforcing = 1
# Retry count for entering new password
retry = 3

# Note: The following policies are enforced by other mechanisms:
# - MFA requirements (2.1): Configured in PAM or application
# - Session timeout (5.1.5): Configured in /etc/profile or PAM
# - Account lockout (5.1.6): Configured in PAM (pam_faillock)
# - Login monitoring (5.1.7): Configured in logging/alerting system
# - Account suspension (5.1.8): Configured in account management system
# - Password hints (5.1.9): Disabled in application configuration

# Additional quality settings
# Check for palindromes
palindrome = 1
# Check for dictionary words
dictpath = /usr/share/dict/words