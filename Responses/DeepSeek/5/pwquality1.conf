# /etc/security/pwquality.conf
# Password quality configuration for PCI DSS compliance

# Password length requirements (8.3.6, 8.2.3)
# Minimum password length: 12 characters for PCI DSS 8.3.6
# Note: 8.2.3 requires minimum 7 characters, but 8.3.6 takes precedence
minlen = 12

# Password complexity requirements (8.3.6, 8.2.3)
# Require at least one digit (numeric character)
dcredit = -1
# Require at least one lowercase letter (alphabetic character)
lcredit = -1
# Require at least one uppercase letter
ucredit = -1
# Require at least one other (special) character
ocredit = -1

# Password history (8.2.5, 8.3.7)
# Remember last 4 passwords (prevents reuse)
remember = 4

# Password aging (8.2.4)
# Note: Password aging is configured in /etc/login.defs, not here
# PASS_MAX_DAYS = 90 should be set in /etc/login.defs

# Password quality checks
# Check if it contains the user name in some form
usercheck = 1
# Number of characters in the new password that must not be present in the old password
difok = 5
# Minimum number of characters that must be different from the old password
minclass = 4
# Maximum number of allowed consecutive same characters
maxrepeat = 2
# Check for monotonic sequences
maxsequence = 3
# Check for geometric sequences
gecoscheck = 1
# Dictionary check
dictcheck = 1
# Enforce for root
enforcing = 1
# Retry prompt
retry = 3

# Note: The following items are NOT configured in pwquality.conf but are required:
# 1. Account lockout (8.1.6, 8.3.4) - Configure in /etc/pam.d/system-auth or /etc/security/faillock.conf
#    - deny=6 (8.1.6) or deny=10 (8.3.4)
#    - unlock_time=1800 (30 minutes)
# 2. Session timeout (8.1.8) - Configure in /etc/profile or shell profiles
#    - TMOUT=900 (15 minutes)
# 3. First-time password reset (8.2.6) - Configure with chage -d 0 <username>
# 4. MFA (8.4.1 to 8.5.1) - Requires external MFA solution
# 5. Encryption of authentication data (8.3.1) - System-wide configuration
# 6. Password change on compromise (8.3.8) - Procedural control
# 7. Hardcoded password prevention (8.6.2, 8.6.3) - Development/operational controls