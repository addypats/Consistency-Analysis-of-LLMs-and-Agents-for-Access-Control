# /etc/security/pwquality.conf
# Password quality configuration for PCI DSS compliance

# Password length requirements (8.3.6, 8.2.3)
# Minimum password length: 12 characters for PCI DSS 8.3.6
# Note: 8.2.3 requires minimum 7 characters, but 8.3.6 takes precedence
minlen = 12

# Password complexity requirements (8.3.6, 8.2.3)
# Require both numeric and alphabetic characters
minclass = 2
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1

# Password history (8.2.5, 8.3.7)
# Do not allow reuse of last 4 passwords
remember = 4

# Password quality checks
# Reject passwords containing the username in some form
usercheck = 1

# Reject passwords containing words from dictionary
dictcheck = 1

# Maximum number of consecutive identical characters
maxrepeat = 3

# Maximum number of consecutive characters of same class
maxclassrepeat = 3

# Check for palindrome
palindrome = 1

# Check for monotonic sequences
gecoscheck = 1

# Check for rotated versions of old password
difok = 5

# Minimum number of characters that must be different from old password
difignore = 5

# Enforce password change policy
# Note: Password aging is configured in /etc/login.defs or /etc/shadow
# PASS_MAX_DAYS should be set to 90 in /etc/login.defs (8.2.4)

# Note: The following policies are not configured in pwquality.conf but in other system files:
# 1. Account lockout after 6 attempts (8.1.6) - Configure in /etc/security/faillock.conf or PAM
# 2. Lockout duration of 30 minutes (8.1.7) - Configure in /etc/security/faillock.conf or PAM
# 3. Session timeout of 15 minutes (8.1.8) - Configure in /etc/profile or PAM
# 4. First-time password reset (8.2.6) - Configure in PAM or application logic
# 5. MFA requirements (8.4.1-8.5.1) - Configure in PAM or authentication system
# 6. Password encryption in transit/storage (8.3.1) - Configure in application/network layer
# 7. Account inactivity removal (8.1.4) - Configure via cron jobs or identity management system
# 8. Hardcoded password prevention (8.6.2, 8.6.3) - Enforced via development policies and code review