# /etc/security/pwquality.conf
# Password quality configuration for PCI DSS compliance

# Password length requirements (PCI DSS 8.3.6, 8.2.3)
# Minimum password length of 12 characters for all users
minlen = 12

# Password complexity requirements
# Require at least one digit (numeric character)
dcredit = -1
# Require at least one lowercase character
lcredit = -1
# Require at least one uppercase character
ucredit = -1
# Require at least one other (special) character
ocredit = -1

# Password history (PCI DSS 8.2.5, 8.3.7)
# Remember last 4 passwords (prevents reuse)
remember = 4

# Password quality checks
# Check if password contains the username in some form
usercheck = 1
# Check if password is a palindrome
palindrome = 1
# Check if password is based on dictionary words
dictcheck = 1
# Maximum number of consecutive identical characters
maxrepeat = 2
# Maximum number of consecutive characters of same class
maxclassrepeat = 2
# Minimum number of character classes required (lower, upper, digit, other)
minclass = 3

# Password aging and rotation (PCI DSS 8.2.4)
# Note: Password aging is configured in /etc/login.defs, not pwquality.conf
# PASS_MAX_DAYS = 90 should be set in /etc/login.defs

# Additional security notes:
# - Account lockout after 6 failed attempts (PCI DSS 8.1.6) should be configured in PAM
# - Lockout duration of 30 minutes (PCI DSS 8.1.7, 8.3.4) should be configured in PAM
# - Session timeout of 15 minutes (PCI DSS 8.1.8) should be configured in /etc/profile or PAM
# - First-time password reset (PCI DSS 8.2.6) should be enforced by application logic
# - MFA requirements (PCI DSS 8.4.1-8.5.1) require additional configuration
# - Password encryption (PCI DSS 8.3.1) is handled by system encryption mechanisms
# - Hardcoded password prevention (PCI DSS 8.6.2, 8.6.3) requires code review processes